{
  "versions": [
    {
      "version": "8.11.22",
      "queries": {
        "exists": "SELECT 1 FROM programs WHERE name = '1Password' AND publisher = 'AgileBits Inc.';"
      },
      "installer_url": "https://c.1password.com/dist/1P/win8/1PasswordSetup-8.11.22.msi",
      "install_script_ref": "8959087b",
      "uninstall_script_ref": "4da59eea",
      "sha256": "5cce5a4ed4caed51482b9a966200d42be5adbf40ad537d1b06a2092dc8f054cf",
      "default_categories": [
        "Productivity"
      ]
    }
  ],
  "refs": {
    "4da59eea": "# 1Password Uninstall Script\n# Uses winget to uninstall the package silently and non-interactively\n\n# Check if winget is available\nif (-not (Get-Command winget -ErrorAction SilentlyContinue)) {\n    Write-Host \"Error: winget is not available on this system\"\n    Exit 1\n}\n\n# Uninstall using winget with silent and non-interactive flags\nwinget uninstall --id AgileBits.1Password `\n    --silent `\n    --disable-interactivity\n\n# Wait a moment for registry/file system updates to propagate\nStart-Sleep -Seconds 3\n\n# Verify the uninstall was successful by checking the Windows registry\n# This matches how appExists() verifies - by checking the programs registry entries\n$registryPaths = @(\n    'HKLM:\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Uninstall\\*',\n    'HKLM:\\SOFTWARE\\WOW6432Node\\Microsoft\\Windows\\CurrentVersion\\Uninstall\\*'\n)\n\n$found = $false\nforeach ($path in $registryPaths) {\n    $items = Get-ItemProperty $path -ErrorAction SilentlyContinue | Where-Object {\n        $_.DisplayName -and ($_.DisplayName -eq \"1Password\" -or $_.DisplayName -like \"1Password*\")\n    }\n    if ($items) {\n        $found = $true\n        Write-Host \"Found registry entry: $($items[0].DisplayName) at $path\"\n        break\n    }\n}\n\n# Also check if the installation directory still exists\nif (-not $found) {\n    $installPath = \"C:\\Program Files\\1Password\"\n    if (Test-Path $installPath) {\n        $found = $true\n        Write-Host \"Installation directory still exists: $installPath\"\n    }\n}\n\nif ($found) {\n    Write-Host \"Error: 1Password is still present in registry or file system after uninstall\"\n    Exit 1\n} else {\n    Write-Host \"Successfully uninstalled 1Password - verified registry and file system\"\n    Exit 0\n}\n\n",
    "8959087b": "$logFile = \"${env:TEMP}/fleet-install-software.log\"\n\ntry {\n\n$installProcess = Start-Process msiexec.exe `\n  -ArgumentList \"/quiet /norestart /lv ${logFile} /i `\"${env:INSTALLER_PATH}`\"\" `\n  -PassThru -Verb RunAs -Wait\n\nGet-Content $logFile -Tail 500\n\nExit $installProcess.ExitCode\n\n} catch {\n  Write-Host \"Error: $_\"\n  Exit 1\n}\n"
  }
}
