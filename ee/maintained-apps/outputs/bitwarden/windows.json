{
  "versions": [
    {
      "version": "2025.11.2",
      "queries": {
        "exists": "SELECT 1 FROM programs WHERE name = 'Bitwarden' AND publisher = 'Bitwarden Inc.';"
      },
      "installer_url": "https://github.com/bitwarden/clients/releases/download/desktop-v2025.11.2/Bitwarden-Installer-2025.11.2.exe",
      "install_script_ref": "b514ead2",
      "uninstall_script_ref": "19d5a649",
      "sha256": "6870d6e1a938748017417f3cfcb8ea60e6d4b0b202f20d53fbd9aa697f6dd4d4",
      "default_categories": [
        "Productivity"
      ]
    }
  ],
  "refs": {
    "19d5a649": "# Attempts to locate Bitwarden's uninstaller from registry and execute it silently\n\n$displayName = \"Bitwarden\"\n$publisher = \"8bit Solutions LLC\"\n$productCode = \"{173a9bac-6f0d-50c4-8202-4744c69d091a}\"\n\n$paths = @(\n  'HKLM:\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Uninstall',\n  'HKLM:\\SOFTWARE\\WOW6432Node\\Microsoft\\Windows\\CurrentVersion\\Uninstall',\n  'HKCU:\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Uninstall',\n  'HKCU:\\SOFTWARE\\WOW6432Node\\Microsoft\\Windows\\CurrentVersion\\Uninstall'\n)\n\n# Function to check if Bitwarden is still installed\nfunction Test-BitwardenInstalled {\n    foreach ($p in $paths) {\n        $items = Get-ItemProperty \"$p\\*\" -ErrorAction SilentlyContinue | Where-Object {\n            ($_.DisplayName -and ($_.DisplayName -eq $displayName -or $_.DisplayName -like \"$displayName*\") -and ($publisher -eq \"\" -or $_.Publisher -eq $publisher)) -or\n            ($_.PSChildName -eq $productCode) -or\n            ($_.ProductCode -eq $productCode)\n        }\n        if ($items) { return $true }\n    }\n    return $false\n}\n\n# Kill any running Bitwarden processes before uninstalling\nStop-Process -Name \"Bitwarden\" -Force -ErrorAction SilentlyContinue\nStart-Sleep -Seconds 2\n\n$uninstall = $null\nforeach ($p in $paths) {\n  $items = Get-ItemProperty \"$p\\*\" -ErrorAction SilentlyContinue | Where-Object {\n    ($_.DisplayName -and ($_.DisplayName -eq $displayName -or $_.DisplayName -like \"$displayName*\") -and ($publisher -eq \"\" -or $_.Publisher -eq $publisher)) -or\n    ($_.PSChildName -eq $productCode) -or\n    ($_.ProductCode -eq $productCode)\n  }\n  if ($items) { $uninstall = $items | Select-Object -First 1; break }\n}\n\nif (-not $uninstall -or -not $uninstall.UninstallString) {\n  Write-Host \"Uninstall entry not found\"\n  Exit 0\n}\n\n$uninstallString = $uninstall.UninstallString\n$exePath = \"\"\n$arguments = \"\"\n\n# Parse the uninstall string to extract executable path and existing arguments\n# Handles both quoted and unquoted paths\nif ($uninstallString -match '^\"([^\"]+)\"(.*)') {\n    $exePath = $matches[1]\n    $arguments = $matches[2].Trim()\n} elseif ($uninstallString -match '^([^\\s]+)(.*)') {\n    $exePath = $matches[1]\n    $arguments = $matches[2].Trim()\n} else {\n    Write-Host \"Error: Could not parse uninstall string: $uninstallString\"\n    Exit 1\n}\n\n# Build argument list array, preserving existing arguments and adding /S for silent\n$argumentList = @()\nif ($arguments -ne '') {\n    # Split existing arguments and add them\n    $argumentList += $arguments -split '\\s+'\n}\n$argumentList += \"/S\"\n\nWrite-Host \"Uninstall executable: $exePath\"\nWrite-Host \"Uninstall arguments: $($argumentList -join ' ')\"\n\n$exitCode = 0\ntry {\n    $processOptions = @{\n        FilePath = $exePath\n        ArgumentList = $argumentList\n        NoNewWindow = $true\n        PassThru = $true\n        Wait = $true\n    }\n    \n    $process = Start-Process @processOptions\n    $exitCode = $process.ExitCode\n    \n    Write-Host \"Uninstall exit code: $exitCode\"\n    \n    # Wait for registry to update after uninstall\n    Start-Sleep -Seconds 5\n    \n    # Check for any running uninstaller processes\n    $uninstallerProcesses = Get-Process | Where-Object { $_.ProcessName -like \"*uninstall*\" -or $_.ProcessName -like \"*Bitwarden*\" }\n    if ($uninstallerProcesses) {\n        Write-Host \"Waiting for uninstaller processes to complete...\"\n        $timeout = 30\n        $elapsed = 0\n        while ($elapsed -lt $timeout -and (Get-Process | Where-Object { $_.ProcessName -like \"*uninstall*\" -or $_.ProcessName -like \"*Bitwarden*\" })) {\n            Start-Sleep -Seconds 2\n            $elapsed += 2\n        }\n    }\n    \n    # Retry checking if app is still installed (up to 10 times, 2 seconds apart)\n    $maxRetries = 10\n    $retryCount = 0\n    while ($retryCount -lt $maxRetries -and (Test-BitwardenInstalled)) {\n        Write-Host \"App still detected, waiting for uninstall to complete... (attempt $($retryCount + 1)/$maxRetries)\"\n        Start-Sleep -Seconds 2\n        $retryCount++\n    }\n    \n    if (Test-BitwardenInstalled) {\n        Write-Host \"Warning: App still detected after uninstall, but uninstaller exited with code $exitCode\"\n        # Don't fail if uninstaller reported success\n        if ($exitCode -eq 0) {\n            Write-Host \"Uninstaller reported success, treating as successful\"\n            $exitCode = 0\n        }\n    } else {\n        Write-Host \"App successfully removed from registry\"\n    }\n    \n} catch {\n    Write-Host \"Error running uninstaller: $_\"\n    $exitCode = 1\n}\n\nExit $exitCode\n\n",
    "b514ead2": "# Learn more about .exe install scripts:\n# http://fleetdm.com/learn-more-about/exe-install-scripts\n\n$exeFilePath = \"${env:INSTALLER_PATH}\"\n\ntry {\n\n# Add arguments to install silently\n# Bitwarden uses NSIS installer with /S for silent and /allusers for machine scope\n$processOptions = @{\n  FilePath = \"$exeFilePath\"\n  ArgumentList = \"/S /allusers\"\n  PassThru = $true\n  Wait = $true\n}\n    \n# Start process and track exit code\n$process = Start-Process @processOptions\n$exitCode = $process.ExitCode\n\n# Prints the exit code\nWrite-Host \"Install exit code: $exitCode\"\nExit $exitCode\n\n} catch {\n  Write-Host \"Error: $_\"\n  Exit 1\n}\n\n"
  }
}
