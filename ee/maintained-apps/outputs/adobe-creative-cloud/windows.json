{
  "versions": [
    {
      "version": "6.8.0.821",
      "queries": {
        "exists": "SELECT 1 FROM programs WHERE name = 'Adobe Creative Cloud' AND publisher = 'Adobe Inc.';"
      },
      "installer_url": "https://prod-rel-ffc-ccm.oobesaas.adobe.com/adobe-ffc-external/core/v1/wam/download?sapCode=KCCC&wamFeature=nuj-live",
      "install_script_ref": "a9f195bd",
      "uninstall_script_ref": "2e80229e",
      "sha256": "c0ebdc88e948ce980fcd1ea7d984b8a27539b34cc22f38bf477f19f42f206bac",
      "default_categories": [
        "Productivity"
      ]
    }
  ],
  "refs": {
    "2e80229e": "# Learn more about .exe uninstall scripts:\n# http://fleetdm.com/learn-more-about/exe-install-scripts\n\n$softwareName = \"Adobe Creative Cloud\"\n$uninstallArgs = \"--silent\" # Adobe Creative Cloud uses --silent for silent uninstall\n\n$exitCode = 0\n\ntry {\n    Write-Host \"Starting Adobe Creative Cloud uninstallation...\"\n\n    $machineKeyPaths = @(\n        'HKLM:\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Uninstall\\*',\n        'HKLM:\\SOFTWARE\\WOW6432Node\\Microsoft\\Windows\\CurrentVersion\\Uninstall\\*'\n    )\n\n    $foundUninstaller = $false\n    foreach ($keyPath in $machineKeyPaths) {\n        $uninstallKeys = Get-ChildItem $keyPath -ErrorAction SilentlyContinue\n        foreach ($key in $uninstallKeys) {\n            $properties = Get-ItemProperty -Path $key.PSPath -ErrorAction SilentlyContinue\n            # Match DisplayName using a wildcard for robustness\n            if ($properties -and $properties.DisplayName -like \"*$softwareName*\") {\n                $foundUninstaller = $true\n                $uninstallCommand = if ($properties.QuietUninstallString) {\n                    $properties.QuietUninstallString\n                } else {\n                    $properties.UninstallString\n                }\n\n                # Split the command and args\n                $splitArgs = $uninstallCommand.Split('\"')\n                if ($splitArgs.Length -gt 1) {\n                    if ($splitArgs.Length -eq 3) {\n                        $existingArgs = $splitArgs[2].Trim()\n                        if ($existingArgs -ne '') {\n                            $uninstallArgs = \"$existingArgs $uninstallArgs\"\n                        }\n                    } elseif ($splitArgs.Length -gt 3) {\n                        Throw \"Uninstall command contains multiple quoted strings. Please update the uninstall script.`nUninstall command: $uninstallCommand\"\n                    }\n                    $uninstallCommand = $splitArgs[1]\n                }\n\n                Write-Host \"Uninstall command: $uninstallCommand\"\n                Write-Host \"Uninstall args: $uninstallArgs\"\n\n                $processOptions = @{\n                    FilePath = $uninstallCommand\n                    ArgumentList = $uninstallArgs\n                    PassThru = $true\n                    Wait = $true\n                    NoNewWindow = $true\n                }\n\n                $process = Start-Process @processOptions\n                $exitCode = $process.ExitCode\n                Write-Host \"Uninstall exit code: $exitCode\"\n                break\n            }\n        }\n        if ($foundUninstaller) { break }\n    }\n\n    if (-not $foundUninstaller) {\n        Write-Host \"Uninstaller for '$softwareName' not found.\"\n        $exitCode = 0 # Exit 0 if already uninstalled\n    }\n\n} catch {\n    Write-Host \"Error: $_\"\n    $exitCode = 1\n}\n\nExit $exitCode\n\n",
    "a9f195bd": "# Learn more about .exe install scripts:\n# http://fleetdm.com/learn-more-about/exe-install-scripts\n\n$exeFilePath = \"${env:INSTALLER_PATH}\"\n\n$exitCode = 0\n\ntry {\n    Write-Host \"Starting Adobe Creative Cloud installation (EXE installer with --silent flag)...\"\n    \n    # Adobe Creative Cloud uses --silent for silent installation\n    $processOptions = @{\n        FilePath = $exeFilePath\n        ArgumentList = \"--silent\"\n        PassThru = $true\n        Wait = $true\n        NoNewWindow = $true\n    }\n    \n    $process = Start-Process @processOptions\n    $exitCode = $process.ExitCode\n    \n    Write-Host \"Install exit code: $exitCode\"\n\n} catch {\n    Write-Host \"Error: $_\"\n    $exitCode = 1\n}\n\nExit $exitCode\n\n"
  }
}
