{
  "versions": [
    {
      "version": "11.75.4",
      "queries": {
        "exists": "SELECT 1 FROM programs WHERE name = 'Postman x64 11.75.4' AND publisher = 'Postman';"
      },
      "installer_url": "https://dl.pstmn.io/download/version/11.75.4/windows_64",
      "install_script_ref": "3898f4b4",
      "uninstall_script_ref": "caf98d6d",
      "sha256": "638d91229a5f61c255cd3a5d8c5a6c677523bb1cdbc1022f52e2e4842f36d30f",
      "default_categories": [
        "Developer tools"
      ]
    }
  ],
  "refs": {
    "3898f4b4": "# Learn more about .exe install scripts:\n# http://fleetdm.com/learn-more-about/exe-install-scripts\n\n$exeFilePath = \"${env:INSTALLER_PATH}\"\n\ntry {\n\n# Add argument to install silently\n# Postman uses --silent for silent installation\n$processOptions = @{\n  FilePath = \"$exeFilePath\"\n  ArgumentList = \"--silent\"\n  PassThru = $true\n  Wait = $true\n}\n    \n# Start process and track exit code\n$process = Start-Process @processOptions\n$exitCode = $process.ExitCode\n\n# Prints the exit code\nWrite-Host \"Install exit code: $exitCode\"\nExit $exitCode\n\n} catch {\n  Write-Host \"Error: $_\"\n  Exit 1\n}\n",
    "caf98d6d": "# Uninstall Postman using winget\n# Since Postman is installed via winget, we can use winget to uninstall it directly\n\n$packageIdentifier = \"Postman.Postman\"\n\ntry {\n    Write-Host \"Uninstalling Postman using winget...\"\n    \n    $processOptions = @{\n        FilePath = \"winget\"\n        ArgumentList = @(\"uninstall\", \"--id\", $packageIdentifier, \"--silent\")\n        PassThru = $true\n        Wait = $true\n        NoNewWindow = $true\n    }\n    \n    $process = Start-Process @processOptions\n    $exitCode = $process.ExitCode\n    \n    Write-Host \"Uninstall exit code: $exitCode\"\n    \n    # Wait a moment for uninstall to complete and registry to update\n    Start-Sleep -Seconds 2\n    \n    # Verify the app is actually gone by checking registry\n    # Even if winget returns a non-zero exit code, if the app is gone, consider it success\n    $displayName = \"Postman\"\n    $publisher = \"Postman Inc.\"\n    $paths = @(\n        'HKLM:\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Uninstall',\n        'HKLM:\\SOFTWARE\\WOW6432Node\\Microsoft\\Windows\\CurrentVersion\\Uninstall',\n        'HKCU:\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Uninstall',\n        'HKCU:\\SOFTWARE\\WOW6432Node\\Microsoft\\Windows\\CurrentVersion\\Uninstall'\n    )\n    \n    $stillInstalled = $false\n    foreach ($p in $paths) {\n        $items = Get-ItemProperty \"$p\\*\" -ErrorAction SilentlyContinue | Where-Object {\n            $_.DisplayName -and ($_.DisplayName -eq $displayName -or $_.DisplayName -like \"$displayName*\") -and ($publisher -eq \"\" -or $_.Publisher -eq $publisher)\n        }\n        if ($items) {\n            $stillInstalled = $true\n            break\n        }\n    }\n    \n    if (-not $stillInstalled) {\n        Write-Host \"Postman successfully uninstalled (verified by registry check)\"\n        Exit 0\n    } elseif ($exitCode -eq 0) {\n        # Exit code 0 but app still found - return success anyway (might be timing)\n        Write-Host \"Winget reported success (exit code 0)\"\n        Exit 0\n    } else {\n        # Non-zero exit code and app still found - return the exit code\n        Write-Host \"Uninstall may have failed - app still found in registry\"\n        Exit $exitCode\n    }\n} catch {\n    Write-Host \"Error running winget uninstall: $_\"\n    Exit 1\n}\n"
  }
}
