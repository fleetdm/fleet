{
  "versions": [
    {
      "version": "11.75.4",
      "queries": {
        "exists": "SELECT 1 FROM programs WHERE name = 'Postman x64 11.75.4' AND publisher = 'Postman';"
      },
      "installer_url": "https://dl.pstmn.io/download/version/11.75.4/windows_64",
      "install_script_ref": "3898f4b4",
      "uninstall_script_ref": "cf7ff644",
      "sha256": "638d91229a5f61c255cd3a5d8c5a6c677523bb1cdbc1022f52e2e4842f36d30f",
      "default_categories": [
        "Developer tools"
      ]
    }
  ],
  "refs": {
    "3898f4b4": "# Learn more about .exe install scripts:\n# http://fleetdm.com/learn-more-about/exe-install-scripts\n\n$exeFilePath = \"${env:INSTALLER_PATH}\"\n\ntry {\n\n# Add argument to install silently\n# Postman uses --silent for silent installation\n$processOptions = @{\n  FilePath = \"$exeFilePath\"\n  ArgumentList = \"--silent\"\n  PassThru = $true\n  Wait = $true\n}\n    \n# Start process and track exit code\n$process = Start-Process @processOptions\n$exitCode = $process.ExitCode\n\n# Prints the exit code\nWrite-Host \"Install exit code: $exitCode\"\nExit $exitCode\n\n} catch {\n  Write-Host \"Error: $_\"\n  Exit 1\n}\n",
    "cf7ff644": "# Attempts to locate Postman's uninstaller from registry and execute it silently\n\n$displayName = \"Postman\"\n$publisher = \"Postman Inc.\"\n\n$paths = @(\n  'HKLM:\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Uninstall',\n  'HKLM:\\SOFTWARE\\WOW6432Node\\Microsoft\\Windows\\CurrentVersion\\Uninstall',\n  'HKCU:\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Uninstall',\n  'HKCU:\\SOFTWARE\\WOW6432Node\\Microsoft\\Windows\\CurrentVersion\\Uninstall'\n)\n\n$uninstall = $null\nforeach ($p in $paths) {\n  $items = Get-ItemProperty \"$p\\*\" -ErrorAction SilentlyContinue | Where-Object {\n    $_.DisplayName -and ($_.DisplayName -eq $displayName -or $_.DisplayName -like \"$displayName*\") -and ($publisher -eq \"\" -or $_.Publisher -eq $publisher)\n  }\n  if ($items) { $uninstall = $items | Select-Object -First 1; break }\n}\n\nif (-not $uninstall) {\n  Write-Host \"Uninstall entry not found\"\n  Exit 0\n}\n\n# Kill any running Postman processes before uninstalling\nStop-Process -Name \"Postman\" -Force -ErrorAction SilentlyContinue\n\n# Prefer QuietUninstallString if available, otherwise use UninstallString\n$uninstallString = if ($uninstall.QuietUninstallString) {\n    $uninstall.QuietUninstallString\n} elseif ($uninstall.UninstallString) {\n    $uninstall.UninstallString\n} else {\n    Write-Host \"No uninstall string found\"\n    Exit 0\n}\n\n$exePath = \"\"\n$arguments = \"\"\n\n# Parse the uninstall string to extract executable path and existing arguments\n# Handles both quoted and unquoted paths\nif ($uninstallString -match '^\"([^\"]+)\"(.*)') {\n    $exePath = $matches[1]\n    $arguments = $matches[2].Trim()\n} elseif ($uninstallString -match '^([^\\s]+)(.*)') {\n    $exePath = $matches[1]\n    $arguments = $matches[2].Trim()\n} else {\n    Write-Host \"Error: Could not parse uninstall string: $uninstallString\"\n    Exit 1\n}\n\n# If QuietUninstallString was used, it likely already has silent args - use as-is\n# Otherwise, add --silent to UninstallString\n$useQuietString = $uninstall.QuietUninstallString -ne $null\n\nif ($useQuietString) {\n    # Use QuietUninstallString exactly as it appears (it should already be silent)\n    Write-Host \"Using QuietUninstallString as-is\"\n    Write-Host \"Uninstall executable: $exePath\"\n    Write-Host \"Uninstall arguments: $arguments\"\n    \n    try {\n        $processOptions = @{\n            FilePath = $exePath\n            NoNewWindow = $true\n            PassThru = $true\n            Wait = $true\n        }\n        \n        if ($arguments -ne '') {\n            $processOptions.ArgumentList = $arguments -split '\\s+'\n        }\n        \n        $process = Start-Process @processOptions\n        $exitCode = $process.ExitCode\n        \n        Write-Host \"Uninstall exit code: $exitCode\"\n    } catch {\n        Write-Host \"Error running uninstaller: $_\"\n        $exitCode = 1\n    }\n} else {\n    # Build argument list array, adding --silent for silent uninstall\n    $argumentList = @()\n    if ($arguments -ne '') {\n        # Split existing arguments and add them\n        $argumentList += $arguments -split '\\s+'\n    }\n    \n    # Only add --silent if it's not already present\n    if ($uninstallString -notmatch '--silent' -and $arguments -notmatch '--silent') {\n        $argumentList += \"--silent\"\n    }\n    \n    Write-Host \"Uninstall executable: $exePath\"\n    Write-Host \"Uninstall arguments: $($argumentList -join ' ')\"\n\n    try {\n        $processOptions = @{\n            FilePath = $exePath\n            ArgumentList = $argumentList\n            NoNewWindow = $true\n            PassThru = $true\n            Wait = $true\n        }\n        \n        $process = Start-Process @processOptions\n        $exitCode = $process.ExitCode\n        \n        Write-Host \"Uninstall exit code: $exitCode\"\n    } catch {\n        Write-Host \"Error running uninstaller: $_\"\n        $exitCode = 1\n    }\n}\n\n# Wait for uninstaller to complete and registry to update\n# Postman's uninstaller may be asynchronous, so wait and poll\n$maxWaitSeconds = 30\n$waitIntervalSeconds = 1\n$waitedSeconds = 0\n\nwhile ($waitedSeconds -lt $maxWaitSeconds) {\n    Start-Sleep -Seconds $waitIntervalSeconds\n    $waitedSeconds += $waitIntervalSeconds\n    \n    # Check if Postman is still in registry\n    $stillInstalled = $false\n    foreach ($p in $paths) {\n        $items = Get-ItemProperty \"$p\\*\" -ErrorAction SilentlyContinue | Where-Object {\n            $_.DisplayName -and ($_.DisplayName -eq $displayName -or $_.DisplayName -like \"$displayName*\") -and ($publisher -eq \"\" -or $_.Publisher -eq $publisher)\n        }\n        if ($items) {\n            $stillInstalled = $true\n            break\n        }\n    }\n    \n    if (-not $stillInstalled) {\n        Write-Host \"Postman successfully uninstalled after $waitedSeconds seconds\"\n        $exitCode = 0\n        break\n    }\n}\n\nif ($stillInstalled) {\n    Write-Host \"Warning: Postman still appears to be installed after $maxWaitSeconds seconds\"\n    # Don't fail - exit code from uninstaller process takes precedence\n}\n\nExit $exitCode\n"
  }
}
