{
  "versions": [
    {
      "version": "3.0.22",
      "queries": {
        "exists": "SELECT 1 FROM programs WHERE name = 'VLC media player' AND publisher = 'VideoLAN';"
      },
      "installer_url": "https://download.videolan.org/pub/videolan/vlc/3.0.22/win64/vlc-3.0.22-win64.msi",
      "install_script_ref": "8959087b",
      "uninstall_script_ref": "9e6b767e",
      "sha256": "48d357c0676a263b0354c555cdb118d228b109a0fc8410374f0e9b437c056495",
      "default_categories": [
        "Productivity"
      ],
      "upgrade_code": "{D2E0205B-0D3A-46E2-ADF7-0504FF48CF04}"
    }
  ],
  "refs": {
    "8959087b": "$logFile = \"${env:TEMP}/fleet-install-software.log\"\n\ntry {\n\n$installProcess = Start-Process msiexec.exe `\n  -ArgumentList \"/quiet /norestart /lv ${logFile} /i `\"${env:INSTALLER_PATH}`\"\" `\n  -PassThru -Verb RunAs -Wait\n\nGet-Content $logFile -Tail 500\n\nExit $installProcess.ExitCode\n\n} catch {\n  Write-Host \"Error: $_\"\n  Exit 1\n}\n",
    "9e6b767e": "# Attempts to locate VLC's product code from registry and uninstall it using msiexec\n\n$displayName = \"VLC media player\"\n$publisher = \"VideoLAN\"\n\n$paths = @(\n  'HKLM:\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Uninstall',\n  'HKLM:\\SOFTWARE\\WOW6432Node\\Microsoft\\Windows\\CurrentVersion\\Uninstall',\n  'HKCU:\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Uninstall',\n  'HKCU:\\SOFTWARE\\WOW6432Node\\Microsoft\\Windows\\CurrentVersion\\Uninstall'\n)\n\n$productCode = $null\nforeach ($p in $paths) {\n  $items = Get-ChildItem -Path $p -ErrorAction SilentlyContinue | ForEach-Object {\n    Get-ItemProperty $_.PSPath -ErrorAction SilentlyContinue\n  } | Where-Object {\n    $_.DisplayName -and ($_.DisplayName -eq $displayName -or $_.DisplayName -like \"$displayName*\") -and ($publisher -eq \"\" -or $_.Publisher -eq $publisher) -and $_.PSChildName -match '^{[A-F0-9]{8}-[A-F0-9]{4}-[A-F0-9]{4}-[A-F0-9]{4}-[A-F0-9]{12}}$'\n  }\n  if ($items) {\n    $productCode = ($items | Select-Object -First 1).PSChildName\n    break\n  }\n}\n\nif (-not $productCode) {\n  Write-Host \"Product code not found for $displayName\"\n  Exit 1\n}\n\nWrite-Host \"Found product code: $productCode\"\nWrite-Host \"Attempting to uninstall using msiexec...\"\n\n$timeoutSeconds = 300  # 5 minute timeout\n\ntry {\n  $process = Start-Process msiexec -ArgumentList @(\"/quiet\", \"/x\", $productCode, \"/norestart\") -PassThru -NoNewWindow\n  \n  # Wait for process with timeout\n  $completed = $process.WaitForExit($timeoutSeconds * 1000)\n  \n  if (-not $completed) {\n    Stop-Process -Id $process.Id -Force -ErrorAction SilentlyContinue\n    Write-Host \"Uninstall timed out after $timeoutSeconds seconds\"\n    Exit 1603  # ERROR_UNINSTALL_FAILURE\n  }\n  \n  # Check exit code and output result\n  if ($process.ExitCode -eq 0) {\n    Write-Host \"Uninstall successful\"\n    Exit 0\n  } else {\n    Write-Host \"Uninstall failed with exit code: $($process.ExitCode)\"\n    Exit $process.ExitCode\n  }\n} catch {\n  Write-Host \"Error running uninstaller: $_\"\n  Exit 1\n}\n\n"
  }
}
