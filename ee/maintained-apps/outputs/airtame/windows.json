{
  "versions": [
    {
      "version": "4.15.0",
      "queries": {
        "exists": "SELECT 1 FROM programs WHERE name = 'Airtame 4.15.0' AND publisher = 'Airtame';"
      },
      "installer_url": "https://downloads.airtame.com/app/latest/win/Airtame-4.15.0-setup.msi",
      "install_script_ref": "8959087b",
      "uninstall_script_ref": "512584f1",
      "sha256": "ae06a1b9ab3a5c706a8d701b9d49e750a3945e6028a9d49ad727d7da30570320",
      "default_categories": [
        "Productivity"
      ],
      "upgrade_code": "{E29931C0-80A4-45BE-8F54-BDC39F9D3C63}"
    }
  ],
  "refs": {
    "512584f1": "# Fleet uninstalls app by finding all related product codes for the specified upgrade code\n# Falls back to product code if upgrade code lookup finds nothing\n$inst = New-Object -ComObject \"WindowsInstaller.Installer\"\n$timeoutSeconds = 300  # 5 minute timeout per product\n$upgradeCode = \"{E29931C0-80A4-45BE-8F54-BDC39F9D3C63}\"\n$productCode = \"{AA404F77-BC09-4A42-A93F-EBB102306039}\"\n\n# First, try to find and uninstall products using the upgrade code\n$relatedProducts = $inst.RelatedProducts($upgradeCode)\n$foundProducts = $false\n\nforeach ($product_code in $relatedProducts) {\n    $foundProducts = $true\n    $process = Start-Process msiexec -ArgumentList @(\"/quiet\", \"/x\", $product_code, \"/norestart\") -PassThru\n    \n    # Wait for process with timeout\n    $completed = $process.WaitForExit($timeoutSeconds * 1000)\n    \n    if (-not $completed) {\n        Stop-Process -Id $process.Id -Force -ErrorAction SilentlyContinue\n        Exit 1603  # ERROR_UNINSTALL_FAILURE\n    }\n    \n    # If the uninstall failed, bail\n    if ($process.ExitCode -ne 0) {\n        Write-Output \"Uninstall for $($product_code) exited $($process.ExitCode)\"\n        Exit $process.ExitCode\n    }\n}\n\n# If no products were found with upgrade code, try product code directly\nif (-not $foundProducts) {\n    Write-Output \"No products found with upgrade code, trying product code directly...\"\n    $process = Start-Process msiexec -ArgumentList @(\"/quiet\", \"/x\", $productCode, \"/norestart\") -PassThru\n    $completed = $process.WaitForExit($timeoutSeconds * 1000)\n    \n    if (-not $completed) {\n        Stop-Process -Id $process.Id -Force -ErrorAction SilentlyContinue\n        Exit 1603  # ERROR_UNINSTALL_FAILURE\n    }\n    \n    if ($process.ExitCode -ne 0) {\n        Write-Output \"Uninstall by product code exited $($process.ExitCode)\"\n        Exit $process.ExitCode\n    }\n}\n\n# All uninstalls succeeded; exit success\nExit 0\n",
    "8959087b": "$logFile = \"${env:TEMP}/fleet-install-software.log\"\n\ntry {\n\n$installProcess = Start-Process msiexec.exe `\n  -ArgumentList \"/quiet /norestart /lv ${logFile} /i `\"${env:INSTALLER_PATH}`\"\" `\n  -PassThru -Verb RunAs -Wait\n\nGet-Content $logFile -Tail 500\n\nExit $installProcess.ExitCode\n\n} catch {\n  Write-Host \"Error: $_\"\n  Exit 1\n}\n"
  }
}
