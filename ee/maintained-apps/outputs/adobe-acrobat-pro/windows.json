{
  "versions": [
    {
      "version": "25.001.20844",
      "queries": {
        "exists": "SELECT 1 FROM programs WHERE name = 'Adobe Acrobat (64-bit)' AND publisher = 'Adobe';"
      },
      "installer_url": "https://trials.adobe.com/AdobeProducts/APRO/Acrobat_HelpX/win32/Acrobat_DC_Web_x64_WWMUI.zip",
      "install_script_ref": "d4b42f12",
      "uninstall_script_ref": "2b267612",
      "sha256": "no_check",
      "default_categories": [
        "Productivity"
      ]
    }
  ],
  "refs": {
    "2b267612": "# Attempts to locate Adobe Acrobat Pro uninstaller from registry and execute it silently\n\n$displayName = \"Adobe Acrobat (64-bit)\"\n$publisher = \"Adobe\"\n\n$paths = @(\n    'HKLM:\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Uninstall',\n    'HKLM:\\SOFTWARE\\WOW6432Node\\Microsoft\\Windows\\CurrentVersion\\Uninstall',\n    'HKCU:\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Uninstall'\n)\n\n$uninstall = $null\nforeach ($p in $paths) {\n    $items = Get-ItemProperty \"$p\\*\" -ErrorAction SilentlyContinue | Where-Object {\n        $_.DisplayName -and ($_.DisplayName -eq $displayName -or $_.DisplayName -like \"$displayName*\") -and ($publisher -eq \"\" -or $_.Publisher -eq $publisher)\n    }\n    if ($items) { $uninstall = $items | Select-Object -First 1; break }\n}\n\nif (-not $uninstall -or -not $uninstall.UninstallString) {\n    Write-Host \"Uninstall entry not found\"\n    Exit 0\n}\n\n# Kill any running Acrobat Pro processes before uninstalling\n$acrobatProcesses = @(\"Acrobat\", \"AcroCEF\", \"AdobeCollabSync\")\nforeach ($proc in $acrobatProcesses) {\n    Stop-Process -Name $proc -Force -ErrorAction SilentlyContinue\n}\n\n$uninstallCommand = $uninstall.UninstallString\n\n# Adobe typically uses MsiExec for uninstall\n# Parse the command to extract the product code\nif ($uninstallCommand -match \"MsiExec\\.exe\\s+/[IX]\\s*(\\{[A-F0-9-]+\\})\") {\n    $productCode = $Matches[1]\n    $uninstallArgs = \"/X $productCode /qn /norestart\"\n    $uninstallCommand = \"MsiExec.exe\"\n} else {\n    Write-Host \"Error: Unable to parse uninstall command: $uninstallCommand\"\n    Exit 1\n}\n\nWrite-Host \"Uninstall command: $uninstallCommand\"\nWrite-Host \"Uninstall args: $uninstallArgs\"\n\ntry {\n    $processOptions = @{\n        FilePath = $uninstallCommand\n        ArgumentList = $uninstallArgs\n        NoNewWindow = $true\n        PassThru = $true\n        Wait = $true\n    }\n\n    $process = Start-Process @processOptions\n    $exitCode = $process.ExitCode\n\n    Write-Host \"Uninstall exit code: $exitCode\"\n\n    # Wait for any remaining MsiExec processes to complete\n    # MsiExec can return before the uninstall is fully complete\n    $timeout = 60\n    $elapsed = 0\n    while ((Get-Process -Name \"msiexec\" -ErrorAction SilentlyContinue) -and ($elapsed -lt $timeout)) {\n        Start-Sleep -Seconds 2\n        $elapsed += 2\n        Write-Host \"Waiting for MsiExec to complete... ($elapsed seconds)\"\n    }\n\n    Exit $exitCode\n} catch {\n    Write-Host \"Error running uninstaller: $_\"\n    Exit 1\n}\n",
    "d4b42f12": "# Learn more about .msi install scripts:\n# http://fleetdm.com/learn-more-about/msi-install-scripts\n\n$zipFilePath = \"${env:INSTALLER_PATH}\"\n$tempExtractPath = Join-Path $env:TEMP \"AdobeAcrobatInstall_$(Get-Random)\"\n\ntry {\n    # Extract the ZIP file\n    Write-Host \"Extracting ZIP to: $tempExtractPath\"\n    Expand-Archive -Path $zipFilePath -DestinationPath $tempExtractPath -Force\n\n    # Path to the MSI within the extracted contents\n    $msiPath = Join-Path $tempExtractPath \"Adobe Acrobat\\AcroPro.msi\"\n\n    if (-not (Test-Path $msiPath)) {\n        Write-Host \"Error: MSI file not found at expected path: $msiPath\"\n        Exit 1\n    }\n\n    Write-Host \"Installing MSI: $msiPath\"\n\n    # Install the MSI silently\n    $processOptions = @{\n        FilePath = \"msiexec.exe\"\n        ArgumentList = \"/i `\"$msiPath`\" /qn /norestart\"\n        PassThru = $true\n        Wait = $true\n        NoNewWindow = $true\n    }\n\n    $process = Start-Process @processOptions\n    $exitCode = $process.ExitCode\n\n    Write-Host \"Install exit code: $exitCode\"\n    Exit $exitCode\n\n} catch {\n    Write-Host \"Error: $_\"\n    Exit 1\n} finally {\n    # Clean up extracted files\n    if (Test-Path $tempExtractPath) {\n        Write-Host \"Cleaning up temporary files...\"\n        Remove-Item -Path $tempExtractPath -Recurse -Force -ErrorAction SilentlyContinue\n    }\n}\n"
  }
}
