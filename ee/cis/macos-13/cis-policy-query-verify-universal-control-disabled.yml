---
apiVersion: v1
kind: policy
spec:
  name: CIS - Ensure Siri is enabled (Based on organization's policy) (MDM Required)
  platforms: macOS
  platform: darwin
  description: |
    With macOS 10.12 Sierra, Apple has introduced Siri from iOS to macOS. While there are data spillage concerns with the use of data-gathering personal assistant software, the risk here does not seem greater in sending queries to Apple through Siri than in sending search terms in a browser to Google or Microsoft. While it is possible that Siri will be used for local actions rather than Internet searches, Siri could, in theory, tell Apple about confidential Programs and Projects that should not be revealed. This appears be a usage edge case.
    In cases where sensitive or protected data is processed and Siri could expose that information through assisting a user in navigating their machine, it should be disabled. Siri does need to phone home to Apple, so it should not be available from air-gapped networks as part of its requirements.
    Most of the use case data published has shown that Siri is a tremendous time saver on iOS where multiple screens and menus need to be navigated through. Information like sports scores, weather, movie times, and simple to-do items on existing calendars can be easily found with Siri. None of the standard use cases should be more risky than already approved activity.
  resolution: |
    Automated method:
    Ask your system administrator to deploy an MDM profile that enables the Bluetooth status in the menu bar.
    Create or edit a configuration profile with the following information:
    1. The `PayloadType` string is com.apple.applicationaccess.
    2. The key to include is allowAssistant.
    3. The key must be set to <true/>.
  query: |
      SELECT 1 WHERE NOT EXISTS (
        SELECT 1 FROM managed_policies WHERE 
            domain='com.apple.applicationaccess' 
            AND 
            name='allowAssistant' 
             AND (value = '0' OR value = 'false')
        );  
  purpose: Informational
  tags: compliance, CIS, CIS_Level1, CIS-macos-13-2.5.1-enable
  contributors: sharon-fdm
