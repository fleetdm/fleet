---
# The latest version of CIS Benchmarks for Windows 10 standalone is version 1.0.1
apiVersion: v1
kind: policy
spec:
  name: CIS - Ensure 'Enforce password history' is set to '24' or more passwords
  platforms: win10
  platform: windows
  description: |
    This policy check determines the number of renewed, unique passwords that have to be associated with a user account before you can reuse an old password.
  resolution: |
    Automatic method:
    Ask your system administrator to establish the recommended configuration via GP, set the following UI path to 24 or more passwords:
    'Computer Configuration\Policies\Windows Settings\Security Settings\Account Policies\Password Policy\Enforce password history'
  query: |
    SELECT 1 FROM security_profile_info WHERE password_history_size >= 24;
  purpose: Informational
  tags: compliance, CIS, CIS_Level1, CIS-win10-stand-alone-1.1.1
  contributors: marcosd4h
---
apiVersion: v1
kind: policy
spec:
  name: CIS - Ensure 'Maximum password age' is set to '365 or fewer days, but not 0'
  platforms: win10
  platform: windows
  description: |
    This policy setting defines how long a user can use their password before it expires.
  resolution: |
    Automatic method:
    Ask your system administrator to establish the recommended configuration via GP, set the
    following UI path to 365 or fewer days, but not 0:
    'Computer Configuration\Policies\Windows Settings\Security Settings\Account Policies\Password Policy\Maximum password age'
  query: |
    SELECT 1 FROM security_profile_info WHERE (maximum_password_age <= 365 AND maximum_password_age != 0);
  purpose: Informational
  tags: compliance, CIS, CIS_Level1, CIS-win10-stand-alone-1.1.2
  contributors: marcosd4h
---
apiVersion: v1
kind: policy
spec:
  name: CIS - Ensure 'Minimum password age' is set to '1 or more days'
  platforms: win10
  platform: windows
  description: |
    This policy setting determines the number of days that you must use a password before you can
    change it. The range of values for this policy setting is between 1 and 999 days.
  resolution: |
    Automatic method:
    Ask your system administrator to establish the recommended configuration via GP, set the
    following UI path to 1 or more days:
    'Computer Configuration\Policies\Windows Settings\Security Settings\Account Policies\Password Policy\Minimum password age'
  query: |
    SELECT 1 FROM security_profile_info WHERE minimum_password_age >= 1;
  purpose: Informational
  tags: compliance, CIS, CIS_Level1, CIS-win10-stand-alone-1.1.3
  contributors: marcosd4h
---
apiVersion: v1
kind: policy
spec:
  name: CIS - Ensure 'Minimum password length' is set to '14 or more characters' 
  platforms: win10
  platform: windows
  description: |
    This policy setting determines the least number of characters that make up a password for a user account.
  resolution: |
    Automatic method:
    Ask your system administrator to establish the recommended configuration via GP, set the
    following UI path to 14 or more characters
    'Computer Configuration\Policies\Windows Settings\Security Settings\Account Policies\Password Policy\Minimum password length'
  query: |
    SELECT 1 FROM security_profile_info WHERE minimum_password_length >= 14;
  purpose: Informational
  tags: compliance, CIS, CIS_Level1, CIS-win10-stand-alone-1.1.4
  contributors: marcosd4h
---
apiVersion: v1
kind: policy
spec:
  name: CIS - Ensure 'Password must meet complexity requirements' is set to 'Enabled' 
  platforms: win10
  platform: windows
  description: |
    This policy setting checks all new passwords to ensure that they meet basic requirements for
    strong passwords. Passwords that contain only alphanumeric characters are extremely easy to
    discover with several publicly available tools.
  resolution: |
    Automatic method:
    Ask your system administrator to establish the recommended configuration via GP, set the
    following UI path to 'Enabled':
    'Computer Configuration\Policies\Windows Settings\Security Settings\Account Policies\Password Policy\Password must meet complexity requirements'
  query: |
    SELECT 1 FROM security_profile_info WHERE password_complexity = 1;
  purpose: Informational
  tags: compliance, CIS, CIS_Level1, CIS-win10-stand-alone-1.1.5
  contributors: marcosd4h
---
apiVersion: v1
kind: policy
spec:
  name: CIS - Ensure 'Relax minimum password length limits' is set to 'Enabled'
  platforms: win10
  platform: windows
  description: |
    This policy setting determines whether the minimum password length setting can be increased beyond the legacy limit of 14 characters.
  resolution: |
    Automatic method:
    Ask your system administrator to establish the recommended configuration via GP, set the
    following UI path to 'Enabled':
    'Computer Configuration\Policies\Windows Settings\Security Settings\Account Policies\Password Policy\Relax minimum password length limits'
  query: |
    SELECT 1 FROM registry WHERE (path = 'HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\Control\\SAM\\RelaxMinimumPasswordLengthLimits' AND data != 0);
  purpose: Informational
  tags: compliance, CIS, CIS_Level1, CIS-win10-stand-alone-1.1.6
  contributors: marcosd4h
---
apiVersion: v1
kind: policy
spec:
  name: CIS - Ensure 'Store passwords using reversible encryption' is set to 'Disabled'
  platforms: win10
  platform: windows
  description: |
    This policy setting determines whether the operating system stores passwords in a way that uses
    reversible encryption, which provides support for application protocols that require knowledge
    of the user's password for authentication purposes. Passwords that are stored with reversible
    encryption are essentially the same as plaintext versions of the passwords.
  resolution: |
    Automatic method:
    Ask your system administrator to establish the recommended configuration via GP, set the following UI path to 'Disabled':
    'Computer Configuration\Policies\Windows Settings\Security Settings\Account Policies\Password Policy\Store passwords using reversible encryption'
  query: |
    SELECT 1 FROM security_profile_info WHERE clear_text_password = 0;
  purpose: Informational
  tags: compliance, CIS, CIS_Level1, CIS-win10-stand-alone-1.1.7
  contributors: marcosd4h
---
apiVersion: v1
kind: policy
spec:
  name: CIS - Ensure 'Account lockout duration' is set to '15 or more minute(s)' (Automated)
  platforms: win10
  platform: windows
  description: |
    This policy setting determines the length of time that must pass before a locked account is unlocked and a user can try to log on again. The setting does this by specifying the number of minutes a locked out account will remain unavailable. If the value for this policy setting is configured to 0, locked out accounts will remain locked out until an administrator manually unlocks them.
    Although it might seem like a good idea to configure the value for this policy setting to a high value, such a configuration will likely increase the number of calls that the help desk receives to unlock accounts locked by mistake. Users should be aware of the length of time a lock remains in place, so that they realize they only need to call the help desk if they have an extremely urgent need to regain access to their computer.
    The recommended state for this setting is: 15 or more minute(s).
    Note: Password Policy settings (section 1.1) and Account Lockout Policy settings (section 1.2) must be applied via the Default Domain Policy GPO in order to be globally in effect on domain user accounts as their default behavior. If these settings are configured in another GPO, they will only affect local user accounts on the computers that receive the GPO. However, custom exceptions to the default password policy and account lockout policy rules for specific domain users and/or groups can be defined using Password Settings Objects (PSOs), which are completely separate from Group Policy and most easily configured using Active Directory Administrative Center.
    Rationale:
    A denial of service (DoS) condition can be created if an attacker abuses the Account lockout threshold and repeatedly attempts to log on with a specific account. Once you configure the Account lockout threshold setting, the account will be locked out after the specified number of failed attempts. If you configure the Account lockout duration setting to 0, then the account will remain locked out until an administrator unlocks it manually.
    Impact:
    Although it may seem like a good idea to configure this policy setting to never automatically unlock an account, such a configuration can increase the number of requests that your organization's help desk receives to unlock accounts that were locked by mistake.
  resolution: |
    Automatic method:
    Ask your system administrator to establish the recommended configuration via GP, set the following UI path to '15 or more minute(s)':
    'Computer Configuration\Policies\Windows Settings\Security Settings\Account Policies\Account Lockout Policy\Account lockout duration'
  query: |
    SELECT 1 FROM todo_add_query;
  purpose: Informational
  tags: compliance, CIS, CIS_Level1, CIS-win10-stand-alone-1.2.1
  contributors: sharon-fdm
---
apiVersion: v1
kind: policy
spec:
  name: CIS - Ensure 'Account lockout threshold' is set to '5 or fewer invalid logon attempt(s), but not 0'
  platforms: win10
  platform: windows
  description: |
    This policy setting determines the number of failed logon attempts before the account is locked. Setting this policy to 0 does not conform to the benchmark as doing so disables the account lockout threshold.
    The recommended state for this setting is: 5 or fewer invalid logon attempt(s), but not 0.
    Note: Password Policy settings (section 1.1) and Account Lockout Policy settings (section 1.2) must be applied via the Default Domain Policy GPO in order to be globally in effect on domain user accounts as their default behavior. If these settings are configured in another GPO, they will only affect local user accounts on the computers that receive the GPO. However, custom exceptions to the default password policy and account lockout policy rules for specific domain users and/or groups can be defined using Password Settings Objects (PSOs), which are completely separate from Group Policy and most easily configured using Active Directory Administrative Center.
    Rationale:
    Setting an account lockout threshold reduces the likelihood that an online password brute force attack will be successful. Setting the account lockout threshold too low introduces risk of increased accidental lockouts and/or a malicious actor intentionally locking out accounts.
  resolution: |
    Automatic method:
    Ask your system administrator to establish the recommended configuration via GP, set the following UI path to '5 or fewer invalid login attempt(s), but not 0':
    'Computer Configuration\Policies\Windows Settings\Security Settings\Account Policies\Account Lockout Policy\Account lockout threshold'
  query: |
    SELECT 1 FROM todo_add_query;
  purpose: Informational
  tags: compliance, CIS, CIS_Level1, CIS-win10-stand-alone-1.2.2
  contributors: sharon-fdm
---
apiVersion: v1
kind: policy
spec:
  name: CIS - Ensure 'Reset account lockout counter after' is set to '15 or more minute(s)' (Automated)
  platforms: win10
  platform: windows
  description: |
    This policy setting determines the length of time before the Account lockout threshold resets to zero. The default value for this policy setting is Not Defined. If the Account lockout threshold is defined, this reset time must be less than or equal to the value for the Account lockout duration setting.
    If you leave this policy setting at its default value or configure the value to an interval that is too long, your environment could be vulnerable to a DoS attack. An attacker could maliciously perform a number of failed logon attempts on all users in the organization, which will lock out their accounts. If no policy were determined to reset the account lockout, it would be a manual task for administrators. Conversely, if a reasonable time value is configured for this policy setting, users would be locked out for a set period until all of the accounts are unlocked automatically.
    The recommended state for this setting is: 15 or more minute(s).
    Note: Password Policy settings (section 1.1) and Account Lockout Policy settings (section 1.2) must be applied via the Default Domain Policy GPO in order to be globally in effect on domain user accounts as their default behavior. If these settings are configured in another GPO, they will only affect local user accounts on the computers that receive the GPO. However, custom exceptions to the default password policy and account lockout policy rules for specific domain users and/or groups can be defined using Password Settings Objects (PSOs), which are completely separate from Group Policy and most easily configured using Active Directory Administrative Center.
    Rationale:
    Users can accidentally lock themselves out of their accounts if they mistype their password multiple times. To reduce the chance of such accidental lockouts, the Reset account lockout counter after setting determines the number of minutes that must elapse before the counter that tracks failed logon attempts and triggers lockouts is reset to 0.
  resolution: |
    Automatic method:
    Ask your system administrator to establish the recommended configuration via GP, set the following UI path to '15 or more minute(s)':
    'Computer Configuration\Policies\Windows Settings\Security Settings\Account Policies\Account Lockout Policy\Reset account lockout counter after'
  query: |
    SELECT 1 FROM todo_add_query;
  purpose: Informational
  tags: compliance, CIS, CIS_Level1, CIS-win10-stand-alone-1.2.3
  contributors: sharon-fdm
---
apiVersion: v1
kind: policy
spec:
  name: CIS - Ensure 'Access Credential Manager as a trusted caller' is set to 'No One'
  platforms: win10
  platform: windows
  description: |
    This security setting is used by Credential Manager during Backup and Restore. No accounts should have this user right, as it is only assigned to Winlogon. Users' saved credentials might be compromised if this user right is assigned to other entities.
    The recommended state for this setting is: No One.
    Rationale:
    If an account is given this right the user of the account may create an application that calls into Credential Manager and is returned the credentials for another user.
    Impact:
    None - this is the default behavior.
  resolution: |
    Automatic method:
    Ask your system administrator to establish the recommended configuration via GP, set the following UI path to an empty list of users:
    'Computer Computer Configuration\Policies\Windows Settings\Security Settings\Local Policies\User Rights Assignment\Access Credential Manager as a trusted caller'
  query: |
    SELECT 1 FROM mdm_bridge where mdm_command_input = "<SyncBody><Get><CmdID>1</CmdID><Item><Target><LocURI>./Device/Vendor/MSFT/Policy/Result/UserRights/AccessCredentialManagerAsTrustedCaller</LocURI></Target></Item></Get></SyncBody>" 
    AND mdm_command_output = "";
  purpose: Informational
  tags: compliance, CIS, CIS_Level1, CIS-win10-stand-alone-2.2.1
  contributors: sharon-fdm
---
apiVersion: v1
kind: policy
spec:
  name: CIS - Ensure 'Access this computer from the network' is set to 'Administrators, Remote Desktop Users'
  platforms: win10
  platform: windows
  description: |
    This policy setting allows other users on the network to connect to the computer and is required by various network protocols that include Server Message Block (SMB)-based protocols, NetBIOS, Common Internet File System (CIFS), and Component Object Model Plus (COM+).
    The recommended state for this setting is: Administrators, Remote Desktop Users.
    Rationale:
    Users who can connect from their computer to the network can access resources on target computers for which they have permission. For example, the Access this computer from the network user right is required for users to connect to shared printers and folders. If this user right is assigned to the Everyone group, then anyone will be able to read the files in those shared folders. However, this situation is unlikely for new installations of Windows Server 2003 with Service Pack 1 (SP1), because the default share and NTFS permissions in Windows Server 2003 do not include the Everyone group. This vulnerability may have a higher level of risk for computers that you upgrade from Windows NT 4.0 or Windows 2000, because the default permissions for these operating systems are not as restrictive as the default permissions in Windows Server 2003.
    Impact:
    If you remove the Access this computer from the network user right on Domain Controllers for all users, no one will be able to log on to the domain or use network resources. If you remove this user right on Member Servers, users will not be able to connect to those servers through the network. Successful negotiation of IPsec connections requires that the initiating machine has this right, therefore if using IPsec, it is recommended that it be assigned to the Authenticated Users group. If you have installed optional components such as ASP.NET or Internet Information Services (IIS), you may need to assign this user right to additional accounts that are required by those components. It is important to verify that authorized users are assigned this user right for the computers they need to access the network.
  resolution: |
    Automatic method:
    Ask your system administrator to establish the recommended configuration via GP, set the following UI path to a list containing only 'Administrators' and 'Remote Desktop Users':
    'Computer Configuration\Policies\Windows Settings\Security Settings\Local Policies\User Rights Assignment\Access this computer from the network'
  query: |
    SELECT 1 FROM mdm_bridge where mdm_command_input = "<SyncBody><Get><CmdID>1</CmdID><Item><Target><LocURI>./Device/Vendor/MSFT/Policy/Result/UserRights/AccessFromNetwork</LocURI></Target></Item></Get></SyncBody>" 
    AND mdm_command_output  LIKE "Administrators_REMOTE INTERACTIVE LOGON";
  purpose: Informational
  tags: compliance, CIS, CIS_Level1, CIS-win10-stand-alone-2.2.2
  contributors: sharon-fdm
---
apiVersion: v1
kind: policy
spec:
  name: CIS - Ensure 'Act as part of the operating system' is set to 'No One' (Automated)
  platforms: win10
  platform: windows
  description: |
    This policy setting allows a process to assume the identity of any user and thus gain access to the resources that the user is authorized to access.
    The recommended state for this setting is: No One.
    Note: This user right is considered a "sensitive privilege" for the purposes of auditing. Rationale:
    The Act as part of the operating system user right is extremely powerful. Anyone with this user right can take complete control of the computer and erase evidence of their activities.
    Rationale:
    The Act as part of the operating system user right is extremely powerful. Anyone with this user right can take complete control of the computer and erase evidence of their activities.
    Impact:
    There should be little or no impact because the Act as part of the operating system user right is rarely needed by any accounts other than the Local System account, which implicitly has this right.
  resolution: |
    Automatic method:
    Ask your system administrator to establish the recommended configuration via GP, set the following UI path to an empty list of users:
    'Computer Configuration\Policies\Windows Settings\Security Settings\Local Policies\User Rights Assignment\Act as part of the operating system'
  query: |
    SELECT 1 FROM mdm_bridge where mdm_command_input = "<SyncBody><Get><CmdID>1</CmdID><Item><Target><LocURI>./Device/Vendor/MSFT/Policy/Config/UserRights/ActAsPartOfTheOperatingSystem</LocURI></Target></Item></Get></SyncBody>" AND mdm_command_output = "";
  purpose: Informational
  tags: compliance, CIS, CIS_Level1, CIS-win10-stand-alone-2.2.3
  contributors: sharon-fdm
---
apiVersion: v1
kind: policy
spec:
  name: CIS - Ensure 'Adjust memory quotas for a process' is set to 'Administrators, LOCAL SERVICE, NETWORK SERVICE'
  platforms: win10
  platform: windows
  description: |
    This policy setting allows a user to adjust the maximum amount of memory that is available to a process. The ability to adjust memory quotas is useful for system tuning, but it can be abused. In the wrong hands, it could be used to launch a denial of service (DoS) attack.
    The recommended state for this setting is: Administrators, LOCAL SERVICE, NETWORK SERVICE.
    Rationale:
    A user with the Adjust memory quotas for a process user right can reduce the amount of memory that is available to any process, which could cause business-critical network applications to become slow or to fail. In the wrong hands, this privilege could be used to start a denial of service (DoS) attack.
    Impact:
    Organizations that have not restricted users to roles with limited privileges will find it difficult to impose this countermeasure. Also, if you have installed optional components such as ASP.NET or IIS, you may need to assign the Adjust memory quotas for a process user right to additional accounts that are required by those components. Otherwise, this countermeasure should have no impact on most computers. If this user right is necessary for a user account, it can be assigned to a local computer account instead of a domain account.
  resolution: |
    Automatic method:
    Ask your system administrator to establish the recommended configuration via GP, set the following UI path to a list of only 'Administrators', 'LOCAL SERVICE' and 'NETWORK SERVICE':
    'Computer Configuration\Policies\Windows Settings\Security Settings\Local Policies\User Rights Assignment\Adjust memory quotas for a process'
  query: |
    SELECT 1 FROM todo_add_query;
  purpose: Informational
  tags: compliance, CIS, CIS_Level1, CIS-win10-stand-alone-2.2.4
  contributors: sharon-fdm
---
apiVersion: v1
kind: policy
spec:
  name: CIS - Ensure 'Allow log on locally' is set to 'Administrators, Users'
  platforms: win10
  platform: windows
  description: |
    This policy setting determines which users can interactively log on to computers in your environment. Logons that are initiated by pressing the CTRL+ALT+DEL key sequence on the client computer keyboard require this user right. Users who attempt to log on through Terminal Services / Remote Desktop Services or IIS also require this user right.
    The recommended state for this setting is: Administrators, Users.
    Note: The Guest account is also assigned this user right by default. Although this account is disabled by default, it's recommended that you configure this setting through Group Policy. However, this user right should generally be restricted to the Administrators and Users groups. Assign this user right to the Backup Operators group if your organization requires that they have this capability.
    Rationale:
    Any account with the Allow log on locally user right can log on at the console of the computer. If you do not restrict this user right to legitimate users who need to be able to log on to the console of the computer, unauthorized users could download and run malicious software to elevate their privileges.
    Impact:
    If you remove these default groups, you could limit the abilities of users who are assigned to specific administrative roles in your environment. You should confirm that delegated activities will not be adversely affected by any changes that you make to the Allow log on locally user right.
  resolution: |
    Automatic method:
    Ask your system administrator to establish the recommended configuration via GP, set the following UI path to a list containing only 'Administrators' and 'Users':
    'Computer Configuration\Policies\Windows Settings\Security Settings\Local Policies\User Rights Assignment\Allow log on locally'
  query: |
    SELECT 1 FROM mdm_bridge where mdm_command_input = "<SyncBody><Get><CmdID>1</CmdID><Item><Target><LocURI>./Device/Vendor/MSFT/Policy/Result/UserRights/AllowLocalLogOn</LocURI></Target></Item></Get></SyncBody>" 
    AND 
    (
        mdm_command_output LIKE "Administrators_Users"
        OR
        mdm_command_output LIKE "Users_Administrators"
    );
  purpose: Informational
  tags: compliance, CIS, CIS_Level1, CIS-win10-stand-alone-2.2.5
  contributors: sharon-fdm
---
apiVersion: v1
kind: policy
spec:
  name: CIS - Ensure 'Allow log on through Remote Desktop Services' is set to 'Administrators, Remote Desktop Users'
  platforms: win10
  platform: windows
  description: |
    This policy setting determines which users or groups have the right to log on as a Remote Desktop Services client. If your organization uses Remote Assistance as part of its help desk strategy, create a group and assign it this user right through Group Policy. If the help desk in your organization does not use Remote Assistance, assign this user right only to the Administrators group or use the Restricted Groups feature to ensure that no user accounts are part of the Remote Desktop Users group.
    Restrict this user right to the Administrators group, and possibly the Remote Desktop Users group, to prevent unwanted users from gaining access to computers on your network by means of the Remote Assistance feature.
    The recommended state for this setting is: Administrators, Remote Desktop Users. Note: The above list is to be treated as a whitelist, which implies that the above
    principals need not be present for assessment of this recommendation to pass.
    Note #2: In all versions of Windows prior to Windows 7, Remote Desktop Services was known as Terminal Services, so you should substitute the older term if comparing against an older OS.
    Rationale:
    Any account with the Allow log on through Remote Desktop Services user right can log on to the remote console of the computer. If you do not restrict this user right to legitimate users who need to log on to the console of the computer, unauthorized users could download and run malicious software to elevate their privileges.
    Impact:
    Removal of the Allow log on through Remote Desktop Services user right from other groups or membership changes in these default groups could limit the abilities of users who perform specific administrative roles in your environment. You should confirm that delegated activities will not be adversely affected.
  resolution: |
    Automatic method:
    Ask your system administrator to establish the recommended configuration via GP, set the following UI path to 'Administrators, Remote Desktop Users':
    'Computer Configuration\Policies\Windows Settings\Security Settings\Local Policies\User Rights Assignment\Allow log on through Remote Desktop Services'
  query: |
    SELECT 1 FROM todo_add_query;
  purpose: Informational
  tags: compliance, CIS, CIS_Level1, CIS-win10-stand-alone-2.2.6
  contributors: sharon-fdm
---
apiVersion: v1
kind: policy
spec:
  name: CIS - Ensure 'Back up files and directories' is set to 'Administrators'
  platforms: win10
  platform: windows
  description: |
    This policy setting allows users to circumvent file and directory permissions to back up the system. This user right is enabled only when an application (such as NTBACKUP) attempts to access a file or directory through the NTFS file system backup application programming interface (API). Otherwise, the assigned file and directory permissions apply.
    The recommended state for this setting is: Administrators.
    Note: This user right is considered a "sensitive privilege" for the purposes of auditing. Rationale:
    Users who are able to back up data from a computer could take the backup media to a non-domain computer on which they have administrative privileges and restore the data. They could take ownership of the files and view any unencrypted data that is contained within the backup set.
    Rationale:
    Users who are able to back up data from a computer could take the backup media to a non- domain computer on which they have administrative privileges and restore the data. They could take ownership of the files and view any unencrypted data that is contained within the backup set.
    Impact:
    Changes in the membership of the groups that have the Back up files and directories user right could limit the abilities of users who are assigned to specific administrative roles in your environment. You should confirm that authorized backup administrators are still able to perform backup operations.
  resolution: |
    Automatic method:
    Ask your system administrator to establish the recommended configuration via GP, set the following UI path to a list containing only 'Administrators':
    'Computer Configuration\Policies\Windows Settings\Security Settings\Local Policies\User Rights Assignment\Back up files and directories'
  query: |
    SELECT 1 FROM mdm_bridge where mdm_command_input = "<SyncBody><Get><CmdID>1</CmdID><Item><Target><LocURI>./Device/Vendor/MSFT/Policy/Result/UserRights/BackupFilesAndDirectories</LocURI></Target></Item></Get></SyncBody>" AND mdm_command_output = "Administrators";
  purpose: Informational
  tags: compliance, CIS, CIS_Level1, CIS-win10-stand-alone-2.2.7
  contributors: sharon-fdm
---
apiVersion: v1
kind: policy
spec:
  name: CIS - Ensure 'Change the system time' is set to 'Administrators, LOCAL SERVICE'
  platforms: win10
  platform: windows
  description: |
    This policy setting determines which users and groups can change the time and date on the internal clock of the computers in your environment. Users who are assigned this user right can affect the appearance of event logs. When a computer's time setting is changed, logged events reflect the new time, not the actual time that the events occurred.
    The recommended state for this setting is: Administrators, LOCAL SERVICE.
    Note: Discrepancies between the time on the local computer and on the Domain Controllers in your environment may cause problems for the Kerberos authentication protocol, which could make it impossible for users to log on to the domain or obtain authorization to access domain resources after they are logged on. Also, problems will occur when Group Policy is applied to client computers if the system time is not synchronized with the Domain Controllers.
  resolution: |
    Automatic method:
    Ask your system administrator to establish the recommended configuration via GP, set the following UI path to 'Administrators, LOCAL SERVICE':
    'Computer Configuration\Policies\Windows Settings\Security Settings\Local Policies\User Rights Assignment\Change the system time'
  query: |
    SELECT 1 FROM mdm_bridge where mdm_command_input = "<SyncBody><Get><CmdID>1</CmdID><Item><Target><LocURI>./Device/Vendor/MSFT/Policy/Result/LocalPoliciesSecurityOptions/Accounts_RenameAdministratorAccount</LocURI></Target></Item></Get></SyncBody>" AND mdm_command_output != "Administrator";
OMA-URI: ./Device/Vendor/MSFT/Policy/Config/UserRights/ChangeSystemTime
Data type: String
Value: Administrators, LOCAL SERVICE

  purpose: Informational
  tags: compliance, CIS, CIS_Level1, CIS-win10-stand-alone-2.2.8
  contributors: sharon-fdm
---
apiVersion: v1
kind: policy
spec:
  name: CIS - Ensure 'Change the time zone' is set to 'Administrators, LOCAL SERVICE, Users'
  platforms: win10
  platform: windows
  description: |
    This setting determines which users can change the time zone of the computer. This ability holds no great danger for the computer and may be useful for mobile workers.
    The recommended state for this setting is: Administrators, LOCAL SERVICE, Users.
    Rationale:
    Changing the time zone represents little vulnerability because the system time is not affected. This setting merely enables users to display their preferred time zone while being synchronized with Domain Controllers in different time zones.
  resolution: |
    Automatic method:
    Ask your system administrator to establish the recommended configuration via GP, set the following UI path to 'Administrators, LOCAL SERVICE, Users':
    'Computer Configuration\Policies\Windows Settings\Security Settings\Local Policies\User Rights Assignment\Change the time zone'
  query: |
    SELECT 1 FROM mdm_bridge where mdm_command_input = "<SyncBody><Get><CmdID>1</CmdID><Item><Target><LocURI>./Device/Vendor/MSFT/Policy/Result/LocalPoliciesSecurityOptions/Accounts_RenameAdministratorAccount</LocURI></Target></Item></Get></SyncBody>" AND mdm_command_output != "Administrator";
OMA-URI: ./Device/Vendor/MSFT/Policy/Config/UserRights/ChangeTimeZone
Data type: String
Value: Administrators, LOCAL SERVICE

  purpose: Informational
  tags: compliance, CIS, CIS_Level1, CIS-win10-stand-alone-2.2.9
  contributors: sharon-fdm
---
apiVersion: v1
kind: policy
spec:
  name: CIS - Ensure 'Create a pagefile' is set to 'Administrators'
  platforms: win10
  platform: windows
  description: |
    This policy setting allows users to change the size of the pagefile. By making the pagefile extremely large or extremely small, an attacker could easily affect the performance of a compromised computer.
    The recommended state for this setting is: Administrators.
    Rationale:
    Users who can change the page file size could make it extremely small or move the file to a highly fragmented storage volume, which could cause reduced computer performance.
  resolution: |
    Automatic method:
    Ask your system administrator to establish the recommended configuration via GP, set the following UI path to 'Administrators':
    'Computer Configuration\Policies\Windows Settings\Security Settings\Local Policies\User Rights Assignment\Create a pagefile'
  query: |
    SELECT 1 FROM mdm_bridge where mdm_command_input = "<SyncBody><Get><CmdID>1</CmdID><Item><Target><LocURI>./Device/Vendor/MSFT/Policy/Result/LocalPoliciesSecurityOptions/Accounts_RenameAdministratorAccount</LocURI></Target></Item></Get></SyncBody>" AND mdm_command_output != "Administrator";
OMA-URI: ./Device/Vendor/MSFT/Policy/Config/UserRights/CreatePageFile
Data type: String
Value: Administrators

  purpose: Informational
  tags: compliance, CIS, CIS_Level1, CIS-win10-stand-alone-2.2.10
  contributors: sharon-fdm
---
apiVersion: v1
kind: policy
spec:
  name: CIS - Ensure 'Create a token object' is set to 'No One'
  platforms: win10
  platform: windows
  description: |
    This policy setting allows a process to create an access token, which may provide elevated rights to access sensitive data.
    The recommended state for this setting is: No One.
    Note: This user right is considered a "sensitive privilege" for the purposes of auditing. Rationale:
    A user account that is given this user right has complete control over the system and can lead to the system being compromised. It is highly recommended that you do not assign any user accounts this right.
    The operating system examines a user's access token to determine the level of the user's privileges. Access tokens are built when users log on to the local computer or connect to a remote computer over a network. When you revoke a privilege, the change is immediately recorded, but the change is not reflected in the user's access token until the next time the user logs on or connects. Users with the ability to create or modify tokens can change the level of access for any currently logged on account. They could escalate their own privileges or create a DoS condition.
  resolution: |
    Automatic method:
    Ask your system administrator to establish the recommended configuration via GP, set the following UI path to 'No One':
    'Computer Configuration\Policies\Windows Settings\Security Settings\Local Policies\User Rights Assignment\Create a token object'
  query: |
    SELECT 1 FROM mdm_bridge where mdm_command_input = "<SyncBody><Get><CmdID>1</CmdID><Item><Target><LocURI>./Device/Vendor/MSFT/Policy/Result/LocalPoliciesSecurityOptions/Accounts_RenameAdministratorAccount</LocURI></Target></Item></Get></SyncBody>" AND mdm_command_output != "Administrator";
OMA-URI: ./Device/Vendor/MSFT/Policy/Config/UserRights/CreateToken
Data type: String
Value: No one

  purpose: Informational
  tags: compliance, CIS, CIS_Level1, CIS-win10-stand-alone-2.2.11
  contributors: sharon-fdm
---
apiVersion: v1
kind: policy
spec:
  name: CIS - Ensure 'Create global objects' is set to 'Administrators, LOCAL SERVICE, NETWORK SERVICE, SERVICE'
  platforms: win10
  platform: windows
  description: |
    This policy setting determines whether users can create global objects that are available to all sessions. Users can still create objects that are specific to their own session if they do not have this user right.
    Users who can create global objects could affect processes that run under other users' sessions. This capability could lead to a variety of problems, such as application failure or data corruption.
    The recommended state for this setting is: Administrators, LOCAL SERVICE, NETWORK SERVICE, SERVICE.
    Rationale:
    Users who can create global objects could affect Windows services and processes that run under other user or system accounts. This capability could lead to a variety of problems, such as application failure, data corruption and elevation of privilege.
  resolution: |
    Automatic method:
    Ask your system administrator to establish the recommended configuration via GP, set the following UI path to 'Administrators, LOCAL SERVICE, NETWORK SERVICE, SERVICE':
    'Computer Configuration\Policies\Windows Settings\Security Settings\Local Policies\User Rights Assignment\Create global objects'
  query: |
    SELECT 1 FROM mdm_bridge where mdm_command_input = "<SyncBody><Get><CmdID>1</CmdID><Item><Target><LocURI>./Device/Vendor/MSFT/Policy/Result/LocalPoliciesSecurityOptions/Accounts_RenameAdministratorAccount</LocURI></Target></Item></Get></SyncBody>" AND mdm_command_output != "Administrator";

  purpose: Informational
  tags: compliance, CIS, CIS_Level1, CIS-win10-stand-alone-2.2.12
  contributors: sharon-fdm
---
apiVersion: v1
kind: policy
spec:
  name: CIS - Ensure 'Create permanent shared objects' is set to 'No One'
  platforms: win10
  platform: windows
  description: |
    This user right is useful to kernel-mode components that extend the object namespace. However, components that run in kernel mode have this user right inherently. Therefore, it is typically not necessary to specifically assign this user right.
    The recommended state for this setting is: No One. Rationale:
    Users who have the Create permanent shared objects user right could create new shared objects and expose sensitive data to the network.
  resolution: |
    Automatic method:
    Ask your system administrator to establish the recommended configuration via GP, set the following UI path to 'No One':
    'Computer Configuration\Policies\Windows Settings\Security Settings\Local Policies\User Rights Assignment\Create permanent shared objects'
  query: |
    SELECT 1 FROM mdm_bridge where mdm_command_input = "<SyncBody><Get><CmdID>1</CmdID><Item><Target><LocURI>./Device/Vendor/MSFT/Policy/Result/LocalPoliciesSecurityOptions/Accounts_RenameAdministratorAccount</LocURI></Target></Item></Get></SyncBody>" AND mdm_command_output != "Administrator";

  purpose: Informational
  tags: compliance, CIS, CIS_Level1, CIS-win10-stand-alone-2.2.13
  contributors: sharon-fdm
---
apiVersion: v1
kind: policy
spec:
  name: CIS - Configure 'Create symbolic links'
  platforms: win10
  platform: windows
  description: |
    This policy setting determines which users can create symbolic links. In Windows Vista, existing NTFS file system objects, such as files and folders, can be accessed by referring to a new kind of file system object called a symbolic link. A symbolic link is a pointer (much like a shortcut or .lnk file) to another file system object, which can be a file, folder, shortcut or another symbolic link. The difference between a shortcut and a symbolic link is that a shortcut only works from within the Windows shell. To other programs and applications, shortcuts are just another file, whereas with symbolic links, the concept of a shortcut is implemented as a feature of the NTFS file system.
    Symbolic links can potentially expose security vulnerabilities in applications that are not designed to use them. For this reason, the privilege for creating symbolic links should only be assigned to trusted users. By default, only Administrators can create symbolic links.
    The recommended state for this setting is: Administrators and (when the Hyper-V feature is installed) NT VIRTUAL MACHINE\Virtual Machines.
    Rationale:
    Users who have the Create symbolic links user right could inadvertently or maliciously expose your system to symbolic link attacks. Symbolic link attacks can be used to change the permissions on a file, to corrupt data, to destroy data, or as a Denial of Service attack.
  resolution: |
    Automatic method:
    Ask your system administrator to establish the recommended configuration via GP, set the following UI path to 'Administrators':
    'Computer Configuration\Policies\Windows Settings\Security Settings\Local Policies\User Rights Assignment\Create symbolic links'
  query: |
    SELECT 1 FROM mdm_bridge where mdm_command_input = "<SyncBody><Get><CmdID>1</CmdID><Item><Target><LocURI>./Device/Vendor/MSFT/Policy/Result/LocalPoliciesSecurityOptions/Accounts_RenameAdministratorAccount</LocURI></Target></Item></Get></SyncBody>" AND mdm_command_output != "Administrator";

  purpose: Informational
  tags: compliance, CIS, CIS_Level1, CIS-win10-stand-alone-2.2.14
  contributors: sharon-fdm
---
apiVersion: v1
kind: policy
spec:
  name: CIS - Ensure 'Debug programs' is set to 'Administrators'
  platforms: win10
  platform: windows
  description: |
    This policy setting determines which user accounts will have the right to attach a debugger to any process or to the kernel, which provides complete access to sensitive and critical operating system components. Developers who are debugging their own applications do not need to be assigned this user right; however, developers who are debugging new system components will need it.
    The recommended state for this setting is: Administrators.
    Note: This user right is considered a "sensitive privilege" for the purposes of auditing. Rationale:
    The Debug programs user right can be exploited to capture sensitive computer information from system memory, or to access and modify kernel or application structures. Some attack tools exploit this user right to extract hashed passwords and other private security information, or to insert rootkit code. By default, the Debug programs user right is assigned only to administrators, which helps to mitigate the risk from this vulnerability.
  resolution: |
    Automatic method:
    Ask your system administrator to establish the recommended configuration via GP, set the following UI path to 'Administrators':
    'Computer Configuration\Policies\Windows Settings\Security Settings\Local Policies\User Rights Assignment\Debug programs'
  query: |
    SELECT 1 FROM mdm_bridge where mdm_command_input = "<SyncBody><Get><CmdID>1</CmdID><Item><Target><LocURI>./Device/Vendor/MSFT/Policy/Result/LocalPoliciesSecurityOptions/Accounts_RenameAdministratorAccount</LocURI></Target></Item></Get></SyncBody>" AND mdm_command_output != "Administrator";

  purpose: Informational
  tags: compliance, CIS, CIS_Level1, CIS-win10-stand-alone-2.2.15
  contributors: sharon-fdm
---
apiVersion: v1
kind: policy
spec:
  name: CIS - Ensure 'Deny access to this computer from the network' to include 'Guests'
  platforms: win10
  platform: windows
  description: |
    This policy setting prohibits users from connecting to a computer from across the network, which would allow users to access and potentially modify data remotely. In high security environments, there should be no need for remote users to access data on a computer. Instead, file sharing should be accomplished through the use of network servers. This user right supersedes the Access this computer from the network user right if an account is subject to both policies.
    The recommended state for this setting is to include: Guests.
    Rationale:
    Users who can log on to the computer over the network can enumerate lists of account names, group names, and shared resources. Users with permission to access shared folders and files can connect over the network and possibly view or modify data.
  resolution: |
    Automatic method:
    Ask your system administrator to establish the recommended configuration via GP, set the following UI path to 'Guests':
    'Computer Configuration\Policies\Windows Settings\Security Settings\Local Policies\User Rights Assignment\Deny access to this computer from the network'
  query: |
    SELECT 1 FROM mdm_bridge where mdm_command_input = "<SyncBody><Get><CmdID>1</CmdID><Item><Target><LocURI>./Device/Vendor/MSFT/Policy/Result/LocalPoliciesSecurityOptions/Accounts_RenameAdministratorAccount</LocURI></Target></Item></Get></SyncBody>" AND mdm_command_output != "Administrator";

  purpose: Informational
  tags: compliance, CIS, CIS_Level1, CIS-win10-stand-alone-2.2.16
  contributors: sharon-fdm
---
apiVersion: v1
kind: policy
spec:
  name: CIS - Ensure 'Deny log on as a batch job' to include 'Guests'
  platforms: win10
  platform: windows
  description: |
    This policy setting determines which accounts will not be able to log on to the computer as a batch job. A batch job is not a batch (.bat) file, but rather a batch-queue facility. Accounts that use the Task Scheduler to schedule jobs need this user right.
    This user right supersedes the Log on as a batch job user right, which could be used to allow accounts to schedule jobs that consume excessive system resources. Such an occurrence could cause a DoS condition. Failure to assign this user right to the recommended accounts can be a security risk.
    The recommended state for this setting is to include: Guests.
    Rationale:
    Accounts that have the Log on as a batch job user right could be used to schedule jobs that could consume excessive computer resources and cause a DoS condition.
  resolution: |
    Automatic method:
    Ask your system administrator to establish the recommended configuration via GP, set the following UI path to 'Guests':
    'Computer Configuration\Policies\Windows Settings\Security Settings\Local Policies\User Rights Assignment\Deny log on as a batch job'
  query: |
    SELECT 1 FROM mdm_bridge where mdm_command_input = "<SyncBody><Get><CmdID>1</CmdID><Item><Target><LocURI>./Device/Vendor/MSFT/Policy/Result/LocalPoliciesSecurityOptions/Accounts_RenameAdministratorAccount</LocURI></Target></Item></Get></SyncBody>" AND mdm_command_output != "Administrator";

  purpose: Informational
  tags: compliance, CIS, CIS_Level1, CIS-win10-stand-alone-2.2.17
  contributors: sharon-fdm
---
apiVersion: v1
kind: policy
spec:
  name: CIS - Ensure 'Deny log on as a service' to include 'Guests'
  platforms: win10
  platform: windows
  description: |
    This security setting determines which service accounts are prevented from registering a process as a service. This user right supersedes the Log on as a service user right if an account is subject to both policies.
    The recommended state for this setting is to include: Guests.
    Note: This security setting does not apply to the System, Local Service, or Network
    Service accounts.
    Rationale:
    Accounts that can log on as a service could be used to configure and start new unauthorized services, such as a keylogger or other malicious software. The benefit of the specified countermeasure is somewhat reduced by the fact that only users with administrative privileges can install and configure services, and an attacker who has already attained that level of access could configure the service to run with the System account.
  resolution: |
    Automatic method:
    Ask your system administrator to establish the recommended configuration via GP, set the following UI path to 'Guests':
    'Computer Configuration\Policies\Windows Settings\Security Settings\Local Policies\User Rights Assignment\Deny log on as a service'
  query: |
    SELECT 1 FROM mdm_bridge where mdm_command_input = "<SyncBody><Get><CmdID>1</CmdID><Item><Target><LocURI>./Device/Vendor/MSFT/Policy/Result/LocalPoliciesSecurityOptions/Accounts_RenameAdministratorAccount</LocURI></Target></Item></Get></SyncBody>" AND mdm_command_output != "Administrator";

  purpose: Informational
  tags: compliance, CIS, CIS_Level1, CIS-win10-stand-alone-2.2.18
  contributors: sharon-fdm
---
apiVersion: v1
kind: policy
spec:
  name: CIS - Ensure 'Deny log on locally' to include 'Guests'
  platforms: win10
  platform: windows
  description: |
    This security setting determines which users are prevented from logging on at the computer. This policy setting supersedes the Allow log on locally policy setting if an account is subject to both policies.
    The recommended state for this setting is to include: Guests.
    Important: If you apply this security policy to the Everyone group, no one will be able to log on locally.
    Rationale:
    Any account with the ability to log on locally could be used to log on at the console of the computer. If this user right is not restricted to legitimate users who need to log on to the console of the computer, unauthorized users might download and run malicious software that elevates their privileges.
  resolution: |
    Automatic method:
    Ask your system administrator to establish the recommended configuration via GP, set the following UI path to 'Guests':
    'Computer Configuration\Policies\Windows Settings\Security Settings\Local Policies\User Rights Assignment\Deny log on locally'
  query: |
    SELECT 1 FROM mdm_bridge where mdm_command_input = "<SyncBody><Get><CmdID>1</CmdID><Item><Target><LocURI>./Device/Vendor/MSFT/Policy/Result/LocalPoliciesSecurityOptions/Accounts_RenameAdministratorAccount</LocURI></Target></Item></Get></SyncBody>" AND mdm_command_output != "Administrator";

  purpose: Informational
  tags: compliance, CIS, CIS_Level1, CIS-win10-stand-alone-2.2.19
  contributors: sharon-fdm
---
apiVersion: v1
kind: policy
spec:
  name: CIS - Ensure 'Deny log on through Remote Desktop Services' to include 'Guests'
  platforms: win10
  platform: windows
  description: |
    This policy setting determines whether users can log on as Remote Desktop clients. This user right supersedes the Allow log on through Remote Desktop Services user right if an account is subject to both policies.
    The recommended state for this setting is to include: Guests.
    Note: In all versions of Windows prior to Windows 7, Remote Desktop Services was known as Terminal Services, so you should substitute the older term if comparing against an older OS.
    Rationale:
    Any account with the right to log on through Remote Desktop Services could be used to log on to the remote console of the computer. If this user right is not restricted to legitimate users who need to log on to the console of the computer, unauthorized users might download and run malicious software that elevates their privileges.
  resolution: |
    Automatic method:
    Ask your system administrator to establish the recommended configuration via GP, set the following UI path to 'Guests':
    'Computer Configuration\Policies\Windows Settings\Security Settings\Local Policies\User Rights Assignment\Deny log on through Remote Desktop Services'
  query: |
    SELECT 1 FROM mdm_bridge where mdm_command_input = "<SyncBody><Get><CmdID>1</CmdID><Item><Target><LocURI>./Device/Vendor/MSFT/Policy/Result/LocalPoliciesSecurityOptions/Accounts_RenameAdministratorAccount</LocURI></Target></Item></Get></SyncBody>" AND mdm_command_output != "Administrator";

  purpose: Informational
  tags: compliance, CIS, CIS_Level1, CIS-win10-stand-alone-2.2.20
  contributors: sharon-fdm
---
apiVersion: v1
kind: policy
spec:
  name: CIS - Ensure 'Enable computer and user accounts to be trusted for delegation' is set to 'No One'
  platforms: win10
  platform: windows
  description: |
    This policy setting allows users to change the Trusted for Delegation setting on a computer object in Active Directory. Abuse of this privilege could allow unauthorized users to impersonate other users on the network.
    The recommended state for this setting is: No One.
    Note: This user right is considered a "sensitive privilege" for the purposes of auditing. Rationale:
    Misuse of the Enable computer and user accounts to be trusted for delegation user right could allow unauthorized users to impersonate other users on the network. An attacker could exploit this privilege to gain access to network resources and make it difficult to determine what has happened after a security incident.
  resolution: |
    Automatic method:
    Ask your system administrator to establish the recommended configuration via GP, set the following UI path to 'No One':
    'Computer Configuration\Policies\Windows Settings\Security Settings\Local Policies\User Rights Assignment\Enable computer and user accounts to be trusted for delegation'
  query: |
    SELECT 1 FROM mdm_bridge where mdm_command_input = "<SyncBody><Get><CmdID>1</CmdID><Item><Target><LocURI>./Device/Vendor/MSFT/Policy/Result/LocalPoliciesSecurityOptions/Accounts_RenameAdministratorAccount</LocURI></Target></Item></Get></SyncBody>" AND mdm_command_output != "Administrator";

  purpose: Informational
  tags: compliance, CIS, CIS_Level1, CIS-win10-stand-alone-2.2.21
  contributors: sharon-fdm
---
apiVersion: v1
kind: policy
spec:
  name: CIS - Ensure 'Force shutdown from a remote system' is set to 'Administrators'
  platforms: win10
  platform: windows
  description: |
    This policy setting allows users to shut down Windows Vista-based and newer computers from remote locations on the network. Anyone who has been assigned this user right can cause a denial of service (DoS) condition, which would make the computer unavailable to service user requests. Therefore, it is recommended that only highly trusted administrators be assigned this user right.
    The recommended state for this setting is: Administrators.
    Rationale:
    Any user who can shut down a computer could cause a DoS condition to occur. Therefore, this user right should be tightly restricted.
  resolution: |
    Automatic method:
    Ask your system administrator to establish the recommended configuration via GP, set the following UI path to 'Administrators':
    'Computer Configuration\Policies\Windows Settings\Security Settings\Local Policies\User Rights Assignment\Force shutdown from a remote system'
  query: |
    SELECT 1 FROM mdm_bridge where mdm_command_input = "<SyncBody><Get><CmdID>1</CmdID><Item><Target><LocURI>./Device/Vendor/MSFT/Policy/Result/LocalPoliciesSecurityOptions/Accounts_RenameAdministratorAccount</LocURI></Target></Item></Get></SyncBody>" AND mdm_command_output != "Administrator";

  purpose: Informational
  tags: compliance, CIS, CIS_Level1, CIS-win10-stand-alone-2.2.22
  contributors: sharon-fdm
---
apiVersion: v1
kind: policy
spec:
  name: CIS - Ensure 'Generate security audits' is set to 'LOCAL SERVICE, NETWORK SERVICE'
  platforms: win10
  platform: windows
  description: |
    This policy setting determines which users or processes can generate audit records in the Security log.
    The recommended state for this setting is: LOCAL SERVICE, NETWORK SERVICE.
    Note: This user right is considered a "sensitive privilege" for the purposes of auditing. Rationale:
    An attacker could use this capability to create a large number of audited events, which would make it more difficult for a system administrator to locate any illicit activity. Also, if the event log is configured to overwrite events as needed, any evidence of unauthorized activities could be overwritten by a large number of unrelated events.
  resolution: |
    Automatic method:
    Ask your system administrator to establish the recommended configuration via GP, set the following UI path to 'LOCAL SERVICE, NETWORK SERVICE':
    'Computer Configuration\Policies\Windows Settings\Security Settings\Local Policies\User Rights Assignment\Generate security audits'
  query: |
    SELECT 1 FROM mdm_bridge where mdm_command_input = "<SyncBody><Get><CmdID>1</CmdID><Item><Target><LocURI>./Device/Vendor/MSFT/Policy/Result/LocalPoliciesSecurityOptions/Accounts_RenameAdministratorAccount</LocURI></Target></Item></Get></SyncBody>" AND mdm_command_output != "Administrator";

  purpose: Informational
  tags: compliance, CIS, CIS_Level1, CIS-win10-stand-alone-2.2.23
  contributors: sharon-fdm
---
apiVersion: v1
kind: policy
spec:
  name: CIS - Ensure 'Impersonate a client after authentication' is set to 'Administrators, LOCAL SERVICE, NETWORK SERVICE, SERVICE'
  platforms: win10
  platform: windows
  description: |
    The policy setting allows programs that run on behalf of a user to impersonate that user (or another specified account) so that they can act on behalf of the user. If this user right is required for this kind of impersonation, an unauthorized user will not be able to convince a client to connect—for example, by remote procedure call (RPC) or named pipes—to a service that they have created to impersonate that client, which could elevate the unauthorized user's permissions to administrative or system levels.
    Services that are started by the Service Control Manager have the built-in Service group added by default to their access tokens. COM servers that are started by the COM infrastructure and configured to run under a specific account also have the Service group added to their access tokens. As a result, these processes are assigned this user right when they are started.
    Also, a user can impersonate an access token if any of the following conditions exist:
    -The access token that is being impersonated is for this user.
    -The user, in this logon session, logged on to the network with explicit credentials
    to create the access token.
    -The requested level is less than Impersonate, such as Anonymous or Identify.
    An attacker with the Impersonate a client after authentication user right could create a service, trick a client to make them connect to the service, and then impersonate that client to elevate the attacker's level of access to that of the client.
    The recommended state for this setting is: Administrators, LOCAL SERVICE, NETWORK SERVICE, SERVICE.
    Note: This user right is considered a "sensitive privilege" for the purposes of auditing.
    Rationale:
    An attacker with the Impersonate a client after authentication user right could create a service, trick a client to make them connect to the service, and then impersonate that client to elevate the attacker's level of access to that of the client.
  resolution: |
    Automatic method:
    Ask your system administrator to establish the recommended configuration via GP, set the following UI path to 'Administrators, LOCAL SERVICE, NETWORK SERVICE, SERVICE':
    'Computer Configuration\Policies\Windows Settings\Security Settings\Local Policies\User Rights Assignment\Impersonate a client after authentication'
  query: |
    SELECT 1 FROM mdm_bridge where mdm_command_input = "<SyncBody><Get><CmdID>1</CmdID><Item><Target><LocURI>./Device/Vendor/MSFT/Policy/Result/LocalPoliciesSecurityOptions/Accounts_RenameAdministratorAccount</LocURI></Target></Item></Get></SyncBody>" AND mdm_command_output != "Administrator";

  purpose: Informational
  tags: compliance, CIS, CIS_Level1, CIS-win10-stand-alone-2.2.24
  contributors: sharon-fdm
---
apiVersion: v1
kind: policy
spec:
  name: CIS - Ensure 'Increase scheduling priority' is set to 'Administrators, Window Manager\Window Manager Group'
  platforms: win10
  platform: windows
  description: |
    This policy setting determines whether users can increase the base priority class of a process. (It is not a privileged operation to increase relative priority within a priority class.) This user right is not required by administrative tools that are supplied with the operating system but might be required by software development tools.
    The recommended state for this setting is: Administrators, Window Manager\Window Manager Group.
    Rationale:
    A user who is assigned this user right could increase the scheduling priority of a process to Real-Time, which would leave little processing time for all other processes and could lead to a DoS condition.
  resolution: |
    Automatic method:
    Ask your system administrator to establish the recommended configuration via GP, set the following UI path to 'Administrators, Window Manager\Window Manager Group':
    'Computer Configuration\Policies\Windows Settings\Security Settings\Local Policies\User Rights Assignment\Increase scheduling priority'
  query: |
    SELECT 1 FROM mdm_bridge where mdm_command_input = "<SyncBody><Get><CmdID>1</CmdID><Item><Target><LocURI>./Device/Vendor/MSFT/Policy/Result/LocalPoliciesSecurityOptions/Accounts_RenameAdministratorAccount</LocURI></Target></Item></Get></SyncBody>" AND mdm_command_output != "Administrator";

  purpose: Informational
  tags: compliance, CIS, CIS_Level1, CIS-win10-stand-alone-2.2.25
  contributors: sharon-fdm
---
apiVersion: v1
kind: policy
spec:
  name: CIS - Ensure 'Load and unload device drivers' is set to 'Administrators'
  platforms: win10
  platform: windows
  description: |
    This policy setting allows users to dynamically load a new device driver on a system. An attacker could potentially use this capability to install malicious code that appears to be a device driver. This user right is required for users to add local printers or printer drivers in Windows Vista.
    The recommended state for this setting is: Administrators.
    Note: This user right is considered a "sensitive privilege" for the purposes of auditing. Rationale:
    Device drivers run as highly privileged code. A user who has the Load and unload device drivers user right could unintentionally install malicious code that masquerades as a device driver. Administrators should exercise greater care and install only drivers with verified digital signatures.
  resolution: |
    Automatic method:
    Ask your system administrator to establish the recommended configuration via GP, set the following UI path to 'Administrators':
    'Computer Configuration\Policies\Windows Settings\Security Settings\Local Policies\User Rights Assignment\Load and unload device drivers'
  query: |
    SELECT 1 FROM mdm_bridge where mdm_command_input = "<SyncBody><Get><CmdID>1</CmdID><Item><Target><LocURI>./Device/Vendor/MSFT/Policy/Result/LocalPoliciesSecurityOptions/Accounts_RenameAdministratorAccount</LocURI></Target></Item></Get></SyncBody>" AND mdm_command_output != "Administrator";

  purpose: Informational
  tags: compliance, CIS, CIS_Level1, CIS-win10-stand-alone-2.2.26
  contributors: sharon-fdm
---
apiVersion: v1
kind: policy
spec:
  name: CIS - Ensure 'Lock pages in memory' is set to 'No One'
  platforms: win10
  platform: windows
  description: |
    This policy setting allows a process to keep data in physical memory, which prevents the system from paging the data to virtual memory on disk. If this user right is assigned, significant degradation of system performance can occur.
    The recommended state for this setting is: No One. Rationale:
    Users with the Lock pages in memory user right could assign physical memory to several processes, which could leave little or no RAM for other processes and result in a DoS condition.
  resolution: |
    Automatic method:
    Ask your system administrator to establish the recommended configuration via GP, set the following UI path to 'No One':
    'Computer Configuration\Policies\Windows Settings\Security Settings\Local Policies\User Rights Assignment\Lock pages in memory'
  query: |
    SELECT 1 FROM mdm_bridge where mdm_command_input = "<SyncBody><Get><CmdID>1</CmdID><Item><Target><LocURI>./Device/Vendor/MSFT/Policy/Result/LocalPoliciesSecurityOptions/Accounts_RenameAdministratorAccount</LocURI></Target></Item></Get></SyncBody>" AND mdm_command_output != "Administrator";

  purpose: Informational
  tags: compliance, CIS, CIS_Level1, CIS-win10-stand-alone-2.2.27
  contributors: sharon-fdm
---
apiVersion: v1
kind: policy
spec:
  name: CIS - Ensure 'Log on as a batch job' is set to 'Administrators'
  platforms: win10
  platform: windows
  description: |
    This policy setting allows accounts to log on using the task scheduler service. Because the task scheduler is often used for administrative purposes, it may be needed in enterprise environments. However, its use should be restricted in high security environments to prevent misuse of system resources or to prevent attackers from using the right to launch malicious code after gaining user level access to a computer.
    The recommended state for this setting is: Administrators. Rationale:
    The Log on as a batch job user right presents a low-risk vulnerability. For most organizations, the default settings are sufficient.
  resolution: |
    Automatic method:
    Ask your system administrator to establish the recommended configuration via GP, set the following UI path to 'Administrators':
    'Computer Configuration\Windows Settings\Security Settings\Local Policies\User Rights Assignment\Log on as a batch job'
  query: |
    SELECT 1 FROM mdm_bridge where mdm_command_input = "<SyncBody><Get><CmdID>1</CmdID><Item><Target><LocURI>./Device/Vendor/MSFT/Policy/Result/LocalPoliciesSecurityOptions/Accounts_RenameAdministratorAccount</LocURI></Target></Item></Get></SyncBody>" AND mdm_command_output != "Administrator";

  purpose: Informational
  tags: compliance, CIS, CIS_Level2, CIS-win10-stand-alone-2.2.28
  contributors: sharon-fdm
---
apiVersion: v1
kind: policy
spec:
  name: CIS - Configure 'Log on as a service'
  platforms: win10
  platform: windows
  description: |
    This policy setting allows accounts to launch network services or to register a process as a service running on the system. This user right should be restricted on any computer in a high security environment, but because many applications may require this privilege, it should be carefully evaluated and tested before configuring it in an enterprise environment. On Windows Vista-based (and newer) computers, no users or groups have this privilege by default.
    The recommended state for this setting is: No One or (when the Hyper-V feature is installed) NT VIRTUAL MACHINE\Virtual Machines.
    Note: The Hyper-V feature was first introduced on Windows workstations with the 64-bit version of Windows 8.0, so the NT VIRTUAL MACHINE\Virtual Machines option does not apply to Windows 7 (or older) versions of Windows. Older OSes should only be configured for No One.
  resolution: |
    Automatic method:
    Ask your system administrator to establish the recommended configuration via GP, set the following UI path to 'No One':
    'Computer Configuration\Windows Settings\Security Settings\Local Policies\User Rights Assignment\Log on as a service'
  query: |
    SELECT 1 FROM mdm_bridge where mdm_command_input = "<SyncBody><Get><CmdID>1</CmdID><Item><Target><LocURI>./Device/Vendor/MSFT/Policy/Result/LocalPoliciesSecurityOptions/Accounts_RenameAdministratorAccount</LocURI></Target></Item></Get></SyncBody>" AND mdm_command_output != "Administrator";

  purpose: Informational
  tags: compliance, CIS, CIS_Level2, CIS-win10-stand-alone-2.2.29
  contributors: sharon-fdm
---
apiVersion: v1
kind: policy
spec:
  name: CIS - Ensure 'Manage auditing and security log' is set to 'Administrators'
  platforms: win10
  platform: windows
  description: |
    This policy setting determines which users can change the auditing options for files and directories and clear the Security log.
    The recommended state for this setting is: Administrators.
    Note: This user right is considered a "sensitive privilege" for the purposes of auditing. Rationale:
    The ability to manage the Security event log is a powerful user right and it should be closely guarded. Anyone with this user right can clear the Security log to erase important evidence of unauthorized activity.
  resolution: |
    Automatic method:
    Ask your system administrator to establish the recommended configuration via GP, set the following UI path to 'Administrators':
    'Computer Configuration\Policies\Windows Settings\Security Settings\Local Policies\User Rights Assignment\Manage auditing and security log'
  query: |
    SELECT 1 FROM mdm_bridge where mdm_command_input = "<SyncBody><Get><CmdID>1</CmdID><Item><Target><LocURI>./Device/Vendor/MSFT/Policy/Result/LocalPoliciesSecurityOptions/Accounts_RenameAdministratorAccount</LocURI></Target></Item></Get></SyncBody>" AND mdm_command_output != "Administrator";

  purpose: Informational
  tags: compliance, CIS, CIS_Level1, CIS-win10-stand-alone-2.2.30
  contributors: sharon-fdm
---
apiVersion: v1
kind: policy
spec:
  name: CIS - Ensure 'Modify an object label' is set to 'No One'
  platforms: win10
  platform: windows
  description: |
    This privilege determines which user accounts can modify the integrity label of objects, such as files, registry keys, or processes owned by other users. Processes running under a user account can modify the label of an object owned by that user to a lower level without this privilege.
The recommended state for this setting is: No One.
Rationale:
By modifying the integrity label of an object owned by another user a malicious user may cause them to execute code at a higher level of privilege than intended.
  resolution: |
    Automatic method:
    Ask your system administrator to establish the recommended configuration via GP, set the following UI path to 'No One':
    'Computer Configuration\Policies\Windows Settings\Security Settings\Local Policies\User Rights Assignment\Modify an object label'
  query: |
    SELECT 1 FROM mdm_bridge where mdm_command_input = "<SyncBody><Get><CmdID>1</CmdID><Item><Target><LocURI>./Device/Vendor/MSFT/Policy/Result/LocalPoliciesSecurityOptions/Accounts_RenameAdministratorAccount</LocURI></Target></Item></Get></SyncBody>" AND mdm_command_output != "Administrator";

  purpose: Informational
  tags: compliance, CIS, CIS_Level1, CIS-win10-stand-alone-2.2.31
  contributors: sharon-fdm
---
apiVersion: v1
kind: policy
spec:
  name: CIS - Ensure 'Modify firmware environment values' is set to 'Administrators'
  platforms: win10
  platform: windows
  description: |
    This policy setting allows users to configure the system-wide environment variables that affect hardware configuration. This information is typically stored in the Last Known Good Configuration. Modification of these values and could lead to a hardware failure that would result in a denial of service condition.
    The recommended state for this setting is: Administrators.
    Note: This user right is considered a "sensitive privilege" for the purposes of auditing. Rationale:
    Anyone who is assigned the Modify firmware environment values user right could configure the settings of a hardware component to cause it to fail, which could lead to data corruption or a DoS condition.
  resolution: |
    Automatic method:
    Ask your system administrator to establish the recommended configuration via GP, set the following UI path to 'Administrators':
    'Computer Configuration\Policies\Windows Settings\Security Settings\Local Policies\User Rights Assignment\Modify firmware environment values'
  query: |
    SELECT 1 FROM mdm_bridge where mdm_command_input = "<SyncBody><Get><CmdID>1</CmdID><Item><Target><LocURI>./Device/Vendor/MSFT/Policy/Result/LocalPoliciesSecurityOptions/Accounts_RenameAdministratorAccount</LocURI></Target></Item></Get></SyncBody>" AND mdm_command_output != "Administrator";

  purpose: Informational
  tags: compliance, CIS, CIS_Level1, CIS-win10-stand-alone-2.2.32
  contributors: sharon-fdm
---
apiVersion: v1
kind: policy
spec:
  name: CIS - Ensure 'Perform volume maintenance tasks' is set to 'Administrators'
  platforms: win10
  platform: windows
  description: |
    This policy setting allows users to manage the system's volume or disk configuration, which could allow a user to delete a volume and cause data loss as well as a denial-of- service condition.
    The recommended state for this setting is: Administrators.
    Note: A workstation with Microsoft SQL Server installed will require a special exception to this recommendation for the account that runs the SQL Server service to be granted this user right.
    Rationale:
    A user who is assigned the Perform volume maintenance tasks user right could delete a volume, which could result in the loss of data or a DoS condition.
  resolution: |
    Automatic method:
    Ask your system administrator to establish the recommended configuration via GP, set the following UI path to 'Administrators':
    'Computer Configuration\Policies\Windows Settings\Security Settings\Local Policies\User Rights Assignment\Perform volume maintenance tasks'
  query: |
    SELECT 1 FROM mdm_bridge where mdm_command_input = "<SyncBody><Get><CmdID>1</CmdID><Item><Target><LocURI>./Device/Vendor/MSFT/Policy/Result/LocalPoliciesSecurityOptions/Accounts_RenameAdministratorAccount</LocURI></Target></Item></Get></SyncBody>" AND mdm_command_output != "Administrator";

  purpose: Informational
  tags: compliance, CIS, CIS_Level1, CIS-win10-stand-alone-2.2.33
  contributors: sharon-fdm
---
apiVersion: v1
kind: policy
spec:
  name: CIS - Ensure 'Profile single process' is set to 'Administrators'
  platforms: win10
  platform: windows
  description: |
    This policy setting determines which users can use tools to monitor the performance of non-system processes. Typically, you do not need to configure this user right to use the Microsoft Management Console (MMC) Performance snap-in. However, you do need this user right if System Monitor is configured to collect data using Windows Management Instrumentation (WMI). Restricting the Profile single process user right prevents intruders from gaining additional information that could be used to mount an attack on the system.
The recommended state for this setting is: Administrators. Rationale:
The Profile single process user right presents a moderate vulnerability. An attacker with this user right could monitor a computer's performance to help identify critical processes that they might wish to attack directly. The attacker may also be able to determine what processes run on the computer so that they could identify countermeasures that they may need to avoid, such as antivirus software, an intrusion- detection system, or which other users are logged on to a computer.
  resolution: |
    Automatic method:
    Ask your system administrator to establish the recommended configuration via GP, set the following UI path to 'Administrators':
    'Computer Configuration\Policies\Windows Settings\Security Settings\Local Policies\User Rights Assignment\Profile single process'
  query: |
    SELECT 1 FROM mdm_bridge where mdm_command_input = "<SyncBody><Get><CmdID>1</CmdID><Item><Target><LocURI>./Device/Vendor/MSFT/Policy/Result/LocalPoliciesSecurityOptions/Accounts_RenameAdministratorAccount</LocURI></Target></Item></Get></SyncBody>" AND mdm_command_output != "Administrator";

  purpose: Informational
  tags: compliance, CIS, CIS_Level1, CIS-win10-stand-alone-2.2.34
  contributors: sharon-fdm
---
apiVersion: v1
kind: policy
spec:
  name: CIS - Ensure 'Profile system performance' is set to 'Administrators, NT SERVICE\WdiServiceHost'
  platforms: win10
  platform: windows
  description: |
    This policy setting allows users to use tools to view the performance of different system processes, which could be abused to allow attackers to determine a system's active processes and provide insight into the potential attack surface of the computer.
The recommended state for this setting is: Administrators, NT SERVICE\WdiServiceHost.
Rationale:
The Profile system performance user right poses a moderate vulnerability. Attackers with this user right could monitor a computer's performance to help identify critical processes that they might wish to attack directly. Attackers may also be able to determine what processes are active on the computer so that they could identify countermeasures that they may need to avoid, such as antivirus software or an intrusion detection system.
  resolution: |
    Automatic method:
    Ask your system administrator to establish the recommended configuration via GP, set the following UI path to 'Administrators, NT SERVICE\WdiServiceHost':
    'Computer Configuration\Policies\Windows Settings\Security Settings\Local Policies\User Rights Assignment\Profile system performance'
  query: |
    SELECT 1 FROM mdm_bridge where mdm_command_input = "<SyncBody><Get><CmdID>1</CmdID><Item><Target><LocURI>./Device/Vendor/MSFT/Policy/Result/LocalPoliciesSecurityOptions/Accounts_RenameAdministratorAccount</LocURI></Target></Item></Get></SyncBody>" AND mdm_command_output != "Administrator";

  purpose: Informational
  tags: compliance, CIS, CIS_Level1, CIS-win10-stand-alone-2.2.35
  contributors: sharon-fdm
---
apiVersion: v1
kind: policy
spec:
  name: CIS - Ensure 'Replace a process level token' is set to 'LOCAL SERVICE, NETWORK SERVICE' 
  platforms: win10
  platform: windows
  description: |
    This policy setting allows one process or service to start another service or process with a different security access token, which can be used to modify the security access token of that sub-process and result in the escalation of privileges.
The recommended state for this setting is: LOCAL SERVICE, NETWORK SERVICE.
Note: This user right is considered a "sensitive privilege" for the purposes of auditing. Rationale:
Users with the Replace a process level token privilege are able to start processes as other users whose credentials they know. They could use this method to hide their unauthorized actions on the computer. (On Windows 2000-based computers, use of the Replace a process level token user right also requires the user to have the Adjust memory quotas for a process user right that is discussed earlier in this section.)
  resolution: |
    Automatic method:
    Ask your system administrator to establish the recommended configuration via GP, set the following UI path to 'LOCAL SERVICE, NETWORK SERVICE':
    'Computer Configuration\Policies\Windows Settings\Security Settings\Local Policies\User Rights Assignment\Replace a process level token'
  query: |
    SELECT 1 FROM mdm_bridge where mdm_command_input = "<SyncBody><Get><CmdID>1</CmdID><Item><Target><LocURI>./Device/Vendor/MSFT/Policy/Result/LocalPoliciesSecurityOptions/Accounts_RenameAdministratorAccount</LocURI></Target></Item></Get></SyncBody>" AND mdm_command_output != "Administrator";

  purpose: Informational
  tags: compliance, CIS, CIS_Level1, CIS-win10-stand-alone-2.2.36
  contributors: sharon-fdm
---
apiVersion: v1
kind: policy
spec:
  name: CIS - AAAAAAAA
  platforms: win10
  platform: windows
  description: |
    This policy setting determines which users can bypass file, directory, registry, and other persistent object permissions when restoring backed up files and directories on computers that run Windows Vista (or newer) in your environment. This user right also determines which users can set valid security principals as object owners; it is similar to the Back up files and directories user right.
The recommended state for this setting is: Administrators.
Note: This user right is considered a "sensitive privilege" for the purposes of auditing. Rationale:
An attacker with the Restore files and directories user right could restore sensitive data to a computer and overwrite data that is more recent, which could lead to loss of important data, data corruption, or a denial of service. Attackers could overwrite executable files that are used by legitimate administrators or system services with versions that include malicious software to grant themselves elevated privileges, compromise data, or install backdoors for continued access to the computer.
Note: Even if the following countermeasure is configured, an attacker could still restore data to a computer in a domain that is controlled by the attacker. Therefore, it is critical that organizations carefully protect the media that is used to back up data.
  resolution: |
    Automatic method:
    Ask your system administrator to establish the recommended configuration via GP, set the following UI path to 'Administrators':
    'directories'
    SELECT 1 FROM mdm_bridge where mdm_command_input = "<SyncBody><Get><CmdID>1</CmdID><Item><Target><LocURI>./Device/Vendor/MSFT/Policy/Result/LocalPoliciesSecurityOptions/Accounts_RenameAdministratorAccount</LocURI></Target></Item></Get></SyncBody>" AND mdm_command_output != "Administrator";

  purpose: Informational
  tags: compliance, CIS, CIS_Level1, CIS-win10-stand-alone-2.2.37
  contributors: sharon-fdm
---
apiVersion: v1
kind: policy
spec:
  name: CIS - Ensure 'Shut down the system' is set to 'Administrators, Users' 
  platforms: win10
  platform: windows
  description: |
    This policy setting determines which users who are logged on locally to the computers in your environment can shut down the operating system with the Shut Down command. Misuse of this user right can result in a denial of service condition.
The recommended state for this setting is: Administrators, Users.
Rationale:
The ability to shut down a workstation should be available generally to Administrators and authorized users of that workstation, but not permitted for guests or unauthorized users - in order to prevent a Denial of Service attack.
  resolution: |
    Automatic method:
    Ask your system administrator to establish the recommended configuration via GP, set the following UI path to 'Administrators, Users':
    'Computer Configuration\Policies\Windows Settings\Security Settings\Local Policies\User Rights Assignment\Shut down the system'
    SELECT 1 FROM mdm_bridge where mdm_command_input = "<SyncBody><Get><CmdID>1</CmdID><Item><Target><LocURI>./Device/Vendor/MSFT/Policy/Result/LocalPoliciesSecurityOptions/Accounts_RenameAdministratorAccount</LocURI></Target></Item></Get></SyncBody>" AND mdm_command_output != "Administrator";

  purpose: Informational
  tags: compliance, CIS, CIS_Level1, CIS-win10-stand-alone-2.2.38
  contributors: sharon-fdm
---
apiVersion: v1
kind: policy
spec:
  name: CIS - Ensure 'Take ownership of files or other objects' is set to 'Administrators'
  platforms: win10
  platform: windows
  description: |
    This policy setting allows users to take ownership of files, folders, registry keys, processes, or threads. This user right bypasses any permissions that are in place to protect objects to give ownership to the specified user.
The recommended state for this setting is: Administrators.
Note: This user right is considered a "sensitive privilege" for the purposes of auditing. Rationale:
Any users with the Take ownership of files or other objects user right can take control of any object, regardless of the permissions on that object, and then make any changes they wish to that object. Such changes could result in exposure of data, corruption of data, or a DoS condition.
  resolution: |
    Automatic method:
    Ask your system administrator to establish the recommended configuration via GP, set the following UI path to 'Administrators':
    'Computer Configuration\Policies\Windows Settings\Security Settings\Local Policies\User Rights Assignment\Take ownership of files or other objects'
    SELECT 1 FROM mdm_bridge where mdm_command_input = "<SyncBody><Get><CmdID>1</CmdID><Item><Target><LocURI>./Device/Vendor/MSFT/Policy/Result/LocalPoliciesSecurityOptions/Accounts_RenameAdministratorAccount</LocURI></Target></Item></Get></SyncBody>" AND mdm_command_output != "Administrator";

  purpose: Informational
  tags: compliance, CIS, CIS_Level1, CIS-win10-stand-alone-2.2.39
  contributors: sharon-fdm
