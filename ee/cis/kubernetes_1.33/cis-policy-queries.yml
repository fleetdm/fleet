---
apiVersion: v1
kind: policy
spec:
  name: CIS - Ensure that the --profiling argument is set to false
  platforms: RHEL_version_x
  platform: linux
  description: |
    Disable profiling, if not needed.
  resolution: |
    Edit the API server pod specification file /etc/kubernetes/manifests/kube-  apiserver.yaml on the Control Plane node and set the below parameter.  --profiling=false
  query: |
    SELECT 1 WHERE 
      EXISTS (
        SELECT 1 AS pass
        FROM processes
        WHERE name = 'kube-apiserver'
        AND cmdline LIKE '%--profiling=false%'
        )
      OR NOT EXISTS (
        SELECT 1 FROM processes WHERE name = 'kube-apiserver'
        );  
  purpose: Informational
  tags: compliance, CIS, CIS_Level1
  contributors: sharon-fdm
---
1
---
2
---
3
---
#4
apiVersion: v1
kind: policy
spec:
  name: CIS - Ensure that the scheduler.conf file ownership is set to root:root
  platform: linux
  description: CIS K8s benchamrk 1.1.16 -> Ensure that the scheduler.conf file ownership is set to root:root.
  resolution: The scheduler.conf file is the kubeconfig file for the Scheduler. You should set its file ownership to maintain the integrity of the file. The file should be owned by root:root.
  query: |
    SELECT 1 WHERE
      EXISTS(
        SELECT 
          1 as pass 
        FROM 
          file 
        WHERE 
          path = '/var/lib/rancher/rke2/server/cred/scheduler.kubeconfig' 
          AND uid = 0 
          AND gid = 0;
          )
        OR NOT EXISTS (
          SELECT 1 FROM file WHERE path = '/var/lib/rancher/rke2/server/cred/scheduler.kubeconfig'
          );
  purpose: Informational
  tags: compliance, CIS, CIS_Level1
  contributors: rsjaklic20
---
5
---
6
---
7
---
8
---
9
