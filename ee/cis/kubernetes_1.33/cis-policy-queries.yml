---
apiVersion: v1
kind: policy
spec:
  name: CIS - Ensure that the --profiling argument is set to false
  platforms: RHEL_version_x
  platform: linux
  description: |
    Disable profiling, if not needed.
  resolution: |
    Edit the API server pod specification file /etc/kubernetes/manifests/kube-  apiserver.yaml on the Control Plane node and set the below parameter.  --profiling=false
  query: |
    SELECT 1 WHERE 
      EXISTS (
        SELECT 1 AS pass
        FROM processes
        WHERE name = 'kube-apiserver'
        AND cmdline LIKE '%--profiling=false%'
        )
      OR NOT EXISTS (
        SELECT 1 FROM processes WHERE name = 'kube-apiserver'
        );  
  purpose: Informational
  tags: compliance, CIS, CIS_Level1
  contributors: sharon-fdm
---
1
---
2
---
3
---
4
---
5
---
apiVersion: v1
kind: policy
spec:
  name: CIS 2.2 - Ensure that the --client-cert-auth argument is set to true
  platform: linux
  description: |
    Enable client authencation on etcd service.
  resolution: |
    Edit the etcd pod specification file /etc/kubernetes/manifests/etcd.yaml on the master node and set the parameter --client-cert-auth="true"
  query: |
    SELECT 1 WHERE
        EXISTS (
            SELECT 1
            FROM processes
            WHERE name = 'etcd'
            AND cmdline LIKE '%--client-cert-auth=true%'
        )
        OR NOT EXISTS (
            SELECT 1 FROM processes WHERE name = 'etcd'
        );
  purpose: Informational
  tags: compliance, CIS, CIS_Level1
  contributors: kc9wwh
---
7
---
8
---
9
