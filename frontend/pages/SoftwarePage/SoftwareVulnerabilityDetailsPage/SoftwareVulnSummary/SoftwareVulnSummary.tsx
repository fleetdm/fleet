import CustomLink from "components/CustomLink";
import DataSet from "components/DataSet";
import ViewAllHostsLink from "components/ViewAllHostsLink";
import { IVulnerability } from "interfaces/vulnerability";
import React from "react";

const baseClass = "software-vuln-summary";

interface ISoftwareVulnSummaryProps {
  vuln: IVulnerability;
  isPremiumTier: boolean;
}

const SoftwareVulnSummary = ({
  vuln,
  isPremiumTier,
}: ISoftwareVulnSummaryProps) => {
  return (
    <div className={baseClass}>
      <span className={`${baseClass}__header`}>
        <h1>{vuln.cve}</h1>
        <span className={`${baseClass}__header-links`}>
          <CustomLink
            url="https://nvd.nist.gov/"
            text="Visit NVD Page"
            newTab
          />
          <ViewAllHostsLink
            customText="View affected hosts"
            queryParams={{ cve: vuln.cve }}
          />
        </span>
      </span>
      <div className={`${baseClass}__description`}>{vuln.cve_description}</div>
      <dl className={`${baseClass}__description-list`}>
        {isPremiumTier && (
          <>
            {/* // TODO - tooltip */}
            <DataSet title="Severity" value={vuln.cvss_score} />
            {/* // TODO - tooltip */}
            <DataSet
              title="Probability of exploit"
              value={vuln.epss_probability}
            />
            <DataSet title="Published" value={vuln.cve_published} />
          </>
        )}

        {/* TODO - is this the right field for "Detected"? */}
        <DataSet title="Detected" value={vuln.created_at} />
        <DataSet title="Affected hosts" value={vuln.host_count} />
      </dl>
    </div>
  );
};

export default SoftwareVulnSummary;
