<div id="connect-vanta" class="container d-flex flex-row justify-content-center" v-cloak>
  <div style="max-width: 620px;">
    <h1>Connect Fleet and Vanta</h1>
    <p>This page allows you to set up an integration between Fleet and Vanta. Once set up, Fleet will submit host and user information to Vanta for compliance purposes.</p>
    <div purpose="vanta-notes">
      <p class="font-weight-bold">Please note:</p>
      <ul>
        <li>Vanta only supports up to 1000 hosts.</li>
        <li>The integration currently only supports macOS hosts.</li>
        <li>We are currently unable to provide macOS auto-update status. In Vanta, all hosts will appear as false. Use this query to see the true list of hosts with auto-update complete.</li>
        <li>This integration is only available to Fleet Premium customers.</li>
      </ul>
    </div>
    <div class="card card-body" purpose="vanta-form">
    <ajax-form :handle-submitting="handleSubmittingAuthorizationForm" :syncing.sync="syncing" :cloud-error.sync="cloudError" :form-errors.sync="formErrors" :form-data="formData" :form-rules="formRules" @submitted="submittedAuthorizationForm()">
      <div class="form-group mb-4">
        <label for="emailAddress">Email</label>
        <input id="emailAddress" type="text" class="form-control d-flex w-100" :class="[formErrors.emailAddress ? 'is-invalid' : '']" v-model.trim="formData.emailAddress">
        <p purpose="input-bottom-label">In case we need to contact you.</p>
        <div class="invalid-feedback mt-2">This doesn’t appear to be a valid email address</div>
      </div>
      <div class="form-group mb-4">
        <label for="fleetInstanceUrl">URL of your Fleet instance</label>
        <input id="fleetInstanceUrl" type="text" class="form-control d-flex w-100" :class="[formErrors.fleetInstanceUrl ? 'is-invalid' : '']" v-model.trim="formData.fleetInstanceUrl">
        <p purpose="input-bottom-label">The full url of your fleet instance (e.g. https://fleet.acme.com)</p>
        <div class="invalid-feedback mt-2"></div>
      </div>
      <div class="form-group mb-4">
        <label for="fleetInstanceUrl">API-only User Key</label>
        <input id="fleetApiKey" type="text" class="form-control d-flex w-100" :class="[formErrors.fleetApiKey ? 'is-invalid' : '']" v-model.trim="formData.fleetApiKey">
        <p purpose="input-bottom-label">Here’s how you can create an <a href="" target="_blank">API-only user.</a></p>
        <div class="invalid-feedback mt-2"></div>
      </div>
      <cloud-error purpose="cloud-error" v-if="cloudError === 'fleetInstanceNotResponding'">
        The Fleet instance could not be reached at the provided URL. Please check to make sure that the provided URL is correct and try resubmitting.
      </cloud-error>
      <cloud-error purpose="cloud-error" v-else-if="cloudError === 'invalidToken'">
        The API key provided could not be used to authorize requests to the provided Fleet instance. Please check that the token provided is valid.
      </cloud-error>
      <cloud-error purpose="cloud-error" v-else-if="cloudError === 'nonApiOnlyUser'">
        The API key provided is not associated with an API-only user.
      </cloud-error>
      <cloud-error purpose="cloud-error" v-else-if="cloudError === 'insufficientPermissions'">
        The API key provided has insuffienct permissions. Please configure the API-only user associated with this token to have the Admin role.
      </cloud-error>
      <cloud-error purpose="cloud-error" v-else-if="cloudError"></cloud-error>
      <ajax-button style="height: 44px;" purpose="submit-button" spinner="true" type="submit" :syncing="syncing" class="btn btn-block btn-lg btn-info" v-if="!cloudError">Connect</ajax-button>
    </ajax-form>

    </div>
  </div>

</div>
<%- /* Expose server-rendered data as window.SAILS_LOCALS :: */ exposeLocalsToBrowser() %>
