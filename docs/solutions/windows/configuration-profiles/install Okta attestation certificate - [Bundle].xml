<Add>
  <!-- Okta needs this certificate deployed to the Users cert store. Using the ./Device LocURI will result in the device not being marked as managed -->
  <!-- SCEP node name - Fleet will replace with certificate ID -->
  <Item>
    <Target>
      <LocURI>./User/Vendor/MSFT/ClientCertificateInstall/SCEP/$FLEET_VAR_SCEP_WINDOWS_CERTIFICATE_ID</LocURI>
    </Target>
    <Meta>
      <Format xmlns="syncml:metinf">node</Format>
    </Meta>
  </Item>
</Add>
<Add>
  <!-- Retry count for SCEP installation -->
  <Item>
    <Target>
      <LocURI>./User/Vendor/MSFT/ClientCertificateInstall/SCEP/$FLEET_VAR_SCEP_WINDOWS_CERTIFICATE_ID/Install/RetryCount</LocURI>
    </Target>
    <Meta>
      <Format xmlns="syncml:metinf">int</Format>
    </Meta>
    <Data>3</Data>
  </Item>
</Add>
<Add>
  <!-- Retry delay for SCEP installation -->
  <Item>
    <Target>
      <LocURI>./User/Vendor/MSFT/ClientCertificateInstall/SCEP/$FLEET_VAR_SCEP_WINDOWS_CERTIFICATE_ID/Install/RetryDelay</LocURI>
    </Target>
    <Meta>
      <Format xmlns="syncml:metinf">int</Format>
    </Meta>
    <Data>10</Data>
  </Item>
</Add>
<Add>
  <!-- Key Usage - keep default for Okta -->
  <Item>
    <Target>
      <LocURI>./User/Vendor/MSFT/ClientCertificateInstall/SCEP/$FLEET_VAR_SCEP_WINDOWS_CERTIFICATE_ID/Install/KeyUsage</LocURI>
    </Target>
    <Meta>
      <Format xmlns="syncml:metinf">int</Format>
    </Meta>
    <Data>160</Data>
  </Item>
</Add>
<Add>
  <!-- Key Length - min 2048 for Okta -->
  <Item>
    <Target>
      <LocURI>./User/Vendor/MSFT/ClientCertificateInstall/SCEP/$FLEET_VAR_SCEP_WINDOWS_CERTIFICATE_ID/Install/KeyLength</LocURI>
    </Target>
    <Meta>
      <Format xmlns="syncml:metinf">int</Format>
    </Meta>
    <Data>2048</Data>
  </Item>
</Add>
<Add>
  <!-- Hash Algorithm - keep default for Okta -->
  <Item>
    <Target>
      <LocURI>./User/Vendor/MSFT/ClientCertificateInstall/SCEP/$FLEET_VAR_SCEP_WINDOWS_CERTIFICATE_ID/Install/HashAlgorithm</LocURI>
    </Target>
    <Meta>
      <Format xmlns="syncml:metinf">chr</Format>
    </Meta>
    <Data>SHA-2</Data>
  </Item>
</Add>
<Add>
  <!-- CN - keep default for Okta -->
  <Item>
    <Target>
      <LocURI>./User/Vendor/MSFT/ClientCertificateInstall/SCEP/$FLEET_VAR_SCEP_WINDOWS_CERTIFICATE_ID/Install/SubjectName</LocURI>
    </Target>
    <Meta>
      <Format xmlns="syncml:metinf">chr</Format>
    </Meta>
    <Data>CN=$FLEET_VAR_HOST_HARDWARE_SERIAL managementAttestation</Data>
  </Item>
</Add>
<Add>
  <!-- Extended Key Usage - keep default for Okta -->
  <Item>
    <Target>
      <LocURI>./User/Vendor/MSFT/ClientCertificateInstall/SCEP/$FLEET_VAR_SCEP_WINDOWS_CERTIFICATE_ID/Install/EKUMapping</LocURI>
    </Target>
    <Meta>
      <Format xmlns="syncml:metinf">chr</Format>
    </Meta>
    <Data>1.3.6.1.4.1.311.10.3.12+1.3.6.1.4.1.311.10.3.4+1.3.6.1.4.1.311.20.2.2+1.3.6.1.5.5.7.3.2</Data>
  </Item>
</Add>
<Add>
  <!-- SCEP Server URL - Fleet will replace this with your secret -->
  <Item>
    <Target>
      <LocURI>./User/Vendor/MSFT/ClientCertificateInstall/SCEP/$FLEET_VAR_SCEP_WINDOWS_CERTIFICATE_ID/Install/ServerURL</LocURI>
    </Target>
    <Meta>
      <Format xmlns="syncml:metinf">chr</Format>
    </Meta>
    <Data>$FLEET_SECRET_OKTA_SCEP_URL</Data>
  </Item>
</Add>
<Add>
  <!-- SCEP Challenge - Fleet will replace this with your secret -->
  <!-- Best practice is not to include special characters. Underscores will break deployment. SCEP: Certificate enroll failed. Result: (The string contains a non-printable character.) -->
  <Item>
    <Target>
      <LocURI>./User/Vendor/MSFT/ClientCertificateInstall/SCEP/$FLEET_VAR_SCEP_WINDOWS_CERTIFICATE_ID/Install/Challenge</LocURI>
    </Target>
    <Meta>
      <Format xmlns="syncml:metinf">chr</Format>
    </Meta>
    <Data>$FLEET_SECRET_OKTA_SCEP_CHALLENGE</Data>
  </Item>
</Add>
<Add>
  <!-- SCEP CA Thumbprint (SHA-256) - Fleet will replace this with your secret -->
  <Item>
    <Target>
      <LocURI>./User/Vendor/MSFT/ClientCertificateInstall/SCEP/$FLEET_VAR_SCEP_WINDOWS_CERTIFICATE_ID/Install/CAThumbprint</LocURI>
    </Target>
    <Meta>
      <Format xmlns="syncml:metinf">chr</Format>
    </Meta>
    <Data>$FLEET_SECRET_OKTA_CA_THUMBPRINT</Data>
  </Item>
</Add>
<Exec>
  <!-- Trigger SCEP enrollment - Fleet automatically uses the correct certificate ID -->
  <Item>
    <Target>
      <LocURI>./User/Vendor/MSFT/ClientCertificateInstall/SCEP/$FLEET_VAR_SCEP_WINDOWS_CERTIFICATE_ID/Install/Enroll</LocURI>
    </Target>
  </Item>
</Exec>
