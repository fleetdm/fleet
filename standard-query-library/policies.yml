---
apiVersion: v1
kind: query
spec:
  query: SELECT 1 FROM bitlocker_info where protection_status = 1;
  purpose: Policy
  name: Get Windows machines with unencrypted hard disks
  description: Checks to make sure that device encryption is enabled on Windows devices.
  platforms: Windows
  resolve: "Option 1: Select the Start button, then select Settings  > Update & Security  > Device encryption. If Device encryption doesn't appear, skip to Option 2. If device encryption is turned off, select Turn on. Option 2: Select the Start button. Then, under Windows System, select Control Panel. Next, select System and Security. Under BitLocker Drive Encryption, select Manage BitLocker. Then, select Turn on BitLocker and then follow the instructions."
  contributors: zwass
---
apiVersion: v1
kind: query
spec:
  query: SELECT 1 FROM gatekeeper WHERE assessments_enabled = 0;
  purpose: Policy
  name: Gatekeeper is enabled on macOS devices
  description: Checks to make sure that the Gatekeeper feature is enabled on macOS devices. This feature enforces code signing and verifies downloaded applications before allowing them to run, thereby reducing the likelihood of inadvertently executing malware.
  platforms: macOS
  resolve: "Run the following command in the Terminal app: /usr/sbin/spctl --master-enable"
  contributors: groob
---
apiVersion: v1
kind: query
spec:
  query: SELECT 1 FROM disk_encryption WHERE user_uuid IS NOT “” AND filevault_status = ‘off’ LIMIT 1;
  purpose: Policy
  name: Filevault is enabled on macOS devices
  description: Checks to make sure that the Filevault feature is enabled on macOS devices.
  platforms: macOS
  resolve: "1. Choose Apple menu > System Preferences, then click Security & Privacy. 2. Click the FileVault tab. 3. Click the Lock icon, then enter an administrator name and password. 4. Click Turn On FileVault."
  contributors: groob
