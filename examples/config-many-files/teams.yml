# Applies to Fleet Basic:
# This configuration file allows for the managing of teams in Fleet.
# The file can be used for the creating, updating, and deleting of teams.
# A team's users, agent options, and enroll secrets are managed with this file.

---
apiVersion: v1
kind: team
spec:
  team:
    name: workstations
    members:
      - email: email1
        role: admin
      - email: email2
        role: maintainer
    # These options will apply to all hosts that belong to the `workstations` team.
    # These options will override the `default` options.
    agent_options:
      options:
        distributed_interval: 3
        distributed_tls_max_attempts: 3
        logger_plugin: tls
        logger_tls_endpoint: /api/v1/osquery/log
        logger_tls_period: 10
      decorators:
        load:
          - "SELECT version FROM osquery_info"
          - "SELECT uuid AS host_uuid FROM system_info"
        always:
          - "SELECT user AS username FROM logged_in_users WHERE user <> '' ORDER BY time LIMIT 1"
        interval:
          3600: "SELECT total_seconds AS uptime FROM uptime"
    # A host that enrolls to Fleet using either of the following enroll secrets
    # is assigned to the workstations team
    enroll_secrets:
      secrets:
        - active: true
          name: workstations
          secret: djRf6C40dp5pP02unLS7
        - active: true
          name: workstations2
          secret: djRf6C40dp5pP02unLS7
---
apiVersion: v1
kind: team
spec:
  team:
    name: servers
    members:
      - email: email1
        role: admin
      - email: email2
        role: maintainer
    # These options will apply to all hosts that belong to the `servers` team.
    # These options will override the `default` options.
    agent_options:
      options:
        distributed_interval: 3
        distributed_tls_max_attempts: 3
        logger_plugin: tls
        logger_tls_endpoint: /api/v1/osquery/log
        logger_tls_period: 10
      decorators:
        load:
          - "SELECT version FROM osquery_info"
          - "SELECT uuid AS host_uuid FROM system_info"
        always:
          - "SELECT user AS username FROM logged_in_users WHERE user <> '' ORDER BY time LIMIT 1"
        interval:
          3600: "SELECT total_seconds AS uptime FROM uptime"
    # A host that enrolls to Fleet using the following enroll secret
    # is assigned to the servers team
    enroll_secrets:
      secrets:
        - active: true
          name: servers
          secret: 4NE6wxMlDwZruCfie8oW
