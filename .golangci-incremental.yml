# This configuration is for incremental linting of new/experimental linters.
# It is used with --new-from-rev to only lint changed code.
# See .golangci.yml for the main linter configuration.
version: "2"

issues:
  max-issues-per-linter: 0 # show all issues
  max-same-issues: 0 # show all issues

linters:
  default: none
  enable:
    - modernize
    - nilaway
  settings:
    custom:
      nilaway:
        type: module
        description: Static analysis tool to detect potential nil panics in Go code.
        settings:
          # Settings must be a "map from string to string" to mimic command line flags: the keys are
          # flag names and the values are the values to the particular flags.
          include-pkgs: "github.com/fleetdm/fleet/v4"
  exclusions:
    generated: strict
    rules:
      # nilaway has a hardcoded 500 CFG block limit (_maxFuncSizeInCFGBlocks). Functions exceeding
      # it produce an INTERNAL ERROR with a bogus $GOROOT path that crashes golangci-lint's
      # generated_file_filter processor. These are informational skip messages, not real findings.
      - linters:
          - nilaway
        text: "INTERNAL ERROR"
