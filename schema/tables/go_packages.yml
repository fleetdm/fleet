name: go_packages
platforms:
  - darwin
  - linux
  - windows
description: Go binaries installed via `go install` in user home directories.
evented: false
columns:
  - name: name
    type: text
    required: false
    description: |-
      The filename of the Go binary.
  - name: version
    type: text
    required: false
    description: |-
      The module version of the binary (e.g. v1.2.3). Shows "(devel)" for binaries built with `go build`.
  - name: module_path
    type: text
    required: false
    description: |-
      The Go module path that produced this binary (e.g. github.com/user/repo).
  - name: import_path
    type: text
    required: false
    description: |-
      The import path of the main package (e.g. github.com/user/repo/cmd/tool).
  - name: go_version
    type: text
    required: false
    description: |-
      The version of the Go toolchain used to build this binary (e.g. go1.22.3).
  - name: installed_path
    type: text
    required: false
    description: |-
      The absolute filesystem path to the binary.
examples: |-
  List all Go packages:

  ```
  SELECT * FROM go_packages;
  ```

  List Go packages with real versions (installed via `go install`):

  ```
  SELECT * FROM go_packages WHERE version <> '(devel)';
  ```

  Find all Go packages for a specific module:

  ```
  SELECT * FROM go_packages WHERE module_path LIKE 'github.com/hashicorp/%';
  ```

notes: |-
  This table is not a core osquery table. It is included as part of Fleet's agent
  ([fleetd](https://fleetdm.com/docs/get-started/anatomy#fleetd)).

  Go binaries compiled with Go 1.18+ embed build information that this table extracts
  using Go's debug/buildinfo package. Binaries built with `go build` will show "(devel)"
  as the version, while those installed via `go install module@version` will show the
  actual version.

  The table scans each user's ~/go/bin directory for Go binaries.
