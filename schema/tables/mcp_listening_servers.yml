name: mcp_listening_servers
notes: This table is a fleetd table. Fleetd tables are built into Fleet's agent (fleetd).
description: Lists processes with listening ports that are responding as [Model Context Protocol (MCP)](https://modelcontextprotocol.io/) servers via HTTP (Many MCP servers use stdio and will not be detected by this table).  This table queries the `listening_ports` and `processes` tables to find listening ports, then probes each port to identify active MCP servers.
platforms:
  - darwin
  - windows
  - linux
evented: false
examples: |-
  List all MCP servers currently running on the system.

  ```
  SELECT * FROM mcp_listening_servers;
  ```
columns:
  - name: pid
    description: The process ID of the process running the MCP server.
    required: false
    type: bigint
  - name: name
    description: The name of the process running the MCP server.
    required: false
    type: text
  - name: cmdline
    description: The full command line of the process running the MCP server.
    required: false
    type: text
  - name: port
    description: The port number on which the MCP server is listening.
    required: false
    type: integer
  - name: address
    description: The network address on which the MCP server is listening (e.g., "127.0.0.1", "0.0.0.0", "::1").
    required: false
    type: text
  - name: protocol_version
    description: The MCP protocol version supported by the server (e.g., "2025-06-18").
    required: false
    type: text
  - name: server_name
    description: The name identifier of the MCP server.
    required: false
    type: text
  - name: server_title
    description: The human-readable title of the MCP server.
    required: false
    type: text
  - name: server_version
    description: The version of the MCP server implementation.
    required: false
    type: text
  - name: has_logging
    description: Indicates if the MCP server supports logging capabilities (1 = true, 0 = false).
    required: false
    type: integer
  - name: has_completions
    description: Indicates if the MCP server supports completion capabilities (1 = true, 0 = false).
    required: false
    type: integer
  - name: instructions
    description: Instructions or description text provided by the MCP server about its purpose and usage.
    required: false
    type: text
  - name: tools
    description: JSON array of tools provided by the MCP server, including their names and descriptions.
    required: false
    type: text
  - name: prompts
    description: JSON array of prompts provided by the MCP server, including their names and descriptions.
    required: false
    type: text
  - name: resources
    description: JSON array of resources provided by the MCP server, including their URIs, names, and descriptions.
    required: false
    type: text

