package file

import (
	"bytes"
	"errors"
	"io"
	"testing"

	"github.com/stretchr/testify/require"
)

func TestCheckPKGSignature(t *testing.T) {
	testCases := []struct {
		in  []byte
		out error
	}{
		{in: []byte{}, out: io.EOF},
		{
			in:  tarFile,
			out: ErrInvalidType,
		},
		{
			in:  unsignedFile,
			out: ErrNotSigned,
		},
		{
			in:  signedFile,
			out: nil,
		},
		{
			in:  wrongTOCFile,
			out: errors.New("decompressing TOC: unexpected EOF"),
		},
	}

	for _, c := range testCases {
		r := bytes.NewReader(c.in)
		err := CheckPKGSignature(r)
		if c.out != nil {
			require.ErrorContains(t, err, c.out.Error())
		} else {
			require.NoError(t, err)
		}
	}
}

// TODO: it would be ideal if we could generate these dinamically instead of
// hardcoding blobs.
//
// To generate the following files, I printed into stdout something on the
// lines of response.body[:header.CompressedSize + 28] (you can get this value from
// parseHeader)
var (
	tarFile = []byte{31, 139, 8, 0, 0, 0, 0, 0, 2, 255, 228, 189, 237, 114, 28, 199, 153, 38, 58, 191, 113, 21, 121, 160, 216, 16, 192, 237}

	wrongTOCFile = []byte{120, 97, 114, 33, 0, 28, 0, 1, 0, 0, 0, 0, 0, 0, 3, 167, 0, 0, 0, 0, 0, 0, 18, 218, 0, 0, 0, 1, 120, 218, 212, 152, 93, 143, 163, 54, 20, 134, 239, 231, 87, 68, 220, 103, 241, 247, 7, 98, 88, 105, 183, 90, 169, 119, 149, 58, 189, 233, 157, 177, 77, 6, 77, 2, 17, 144, 233, 204, 254, 250, 26, 67, 18, 162, 144}

	unsignedFile = []byte{120, 97, 114, 33, 0, 28, 0, 1, 0, 0, 0, 0, 0, 0, 3, 167, 0, 0, 0, 0, 0, 0, 18, 218, 0, 0, 0, 1, 120, 218, 212, 152, 93, 143, 163, 54, 20, 134, 239, 231, 87, 68, 220, 103, 241, 247, 7, 98, 88, 105, 183, 90, 169, 119, 149, 58, 189, 233, 157, 177, 77, 6, 77, 2, 17, 144, 233, 204, 254, 250, 26, 67, 18, 162, 144, 132, 52, 81, 180, 149, 34, 97, 204, 177, 143, 225, 61, 207, 107, 66, 252, 245, 99, 181, 156, 189, 219, 170, 206, 203, 226, 57, 128, 95, 64, 48, 179, 133, 46, 77, 94, 44, 158, 131, 191, 94, 126, 204, 69, 240, 53, 121, 138, 63, 84, 149, 60, 205, 226, 166, 212, 238, 48, 139, 117, 101, 85, 227, 70, 204, 155, 124, 101, 19, 4, 16, 158, 3, 60, 199, 224, 5, 210, 136, 2, 247, 139, 195, 195, 16, 63, 232, 213, 234, 183, 122, 179, 154, 213, 205, 231, 210, 62, 7, 245, 171, 130, 65, 123, 101, 22, 151, 89, 86, 219, 38, 113, 195, 250, 150, 239, 173, 243, 159, 237, 228, 113, 232, 27, 237, 20, 225, 118, 14, 127, 150, 229, 75, 59, 203, 205, 115, 192, 250, 105, 140, 106, 148, 111, 205, 226, 165, 45, 22, 205, 107, 194, 37, 142, 195, 190, 221, 93, 216, 222, 221, 118, 21, 106, 189, 94, 230, 218, 47, 53, 44, 117, 99, 155, 121, 221, 184, 165, 175, 130, 176, 31, 208, 175, 8, 98, 130, 8, 99, 16, 29, 172, 177, 95, 164, 79, 179, 93, 101, 155, 228, 163, 169, 148, 155, 204, 204, 199, 111, 218, 96, 173, 21, 166, 154, 100, 41, 161, 74, 139, 52, 203, 120, 134, 152, 210, 90, 3, 37, 5, 50, 72, 32, 77, 57, 140, 195, 227, 153, 250, 20, 170, 210, 175, 249, 251, 29, 50, 28, 77, 212, 61, 203, 112, 247, 48, 227, 31, 121, 97, 108, 245, 189, 21, 212, 190, 244, 106, 186, 238, 66, 21, 101, 109, 117, 89, 152, 186, 85, 110, 120, 218, 5, 120, 229, 161, 4, 96, 14, 224, 28, 128, 23, 128, 34, 74, 34, 202, 226, 112, 91, 19, 46, 205, 232, 228, 177, 30, 47, 44, 44, 255, 118, 53, 176, 31, 189, 58, 19, 182, 218, 135, 169, 51, 97, 106, 31, 182, 168, 202, 205, 58, 169, 27, 149, 101, 113, 216, 157, 116, 253, 185, 241, 101, 216, 30, 125, 199, 166, 182, 85, 242, 243, 31, 85, 215, 113, 232, 219, 93, 175, 187, 76, 129, 123, 162, 155, 109, 220, 170, 52, 54, 1, 12, 184, 177, 190, 217, 21, 169, 125, 207, 181, 45, 202, 4, 50, 206, 57, 66, 110, 192, 174, 203, 7, 228, 69, 27, 43, 48, 129, 66, 2, 25, 135, 221, 185, 191, 212, 124, 174, 109, 210, 150, 189, 123, 132, 109, 243, 169, 211, 193, 221, 192, 111, 185, 43, 219, 60, 221, 180, 117, 220, 106, 209, 51, 23, 182, 193, 135, 176, 108, 153, 187, 155, 170, 36, 194, 224, 38, 85, 201, 52, 85, 201, 52, 85, 201, 99, 84, 229, 148, 254, 119, 85, 249, 177, 170, 38, 175, 172, 110, 202, 234, 243, 72, 218, 84, 213, 246, 203, 250, 109, 177, 151, 117, 160, 38, 10, 122, 89, 246, 222, 183, 51, 63, 204, 9, 228, 135, 246, 119, 189, 255, 237, 12, 16, 29, 186, 243, 214, 250, 250, 36, 123, 243, 155, 224, 126, 153, 102, 216, 164, 136, 27, 194, 82, 138, 53, 53, 214, 121, 148, 48, 220, 48, 145, 73, 97, 44, 212, 214, 32, 67, 79, 187, 223, 101, 251, 155, 156, 98, 220, 254, 134, 254, 119, 10, 149, 203, 172, 28, 195, 130, 80, 132, 68, 4, 135, 176, 156, 162, 101, 42, 46, 83, 121, 153, 10, 204, 73, 98, 142, 145, 57, 193, 204, 8, 52, 59, 47, 36, 100, 64, 205, 101, 108, 14, 185, 33, 96, 200, 205, 184, 29, 246, 208, 124, 43, 87, 67, 94, 118, 62, 56, 64, 7, 159, 65, 167, 221, 237, 129, 64, 28, 220, 13, 31, 199, 9, 230, 163, 4, 13, 114, 93, 67, 81, 166, 160, 171, 107, 46, 17, 86, 153, 201, 56, 176, 80, 41, 87, 233, 8, 51, 204, 152, 148, 152, 50, 65, 141, 66, 217, 13, 20, 77, 79, 241, 88, 138, 0, 117, 69, 27, 81, 116, 19, 69, 98, 34, 69, 98, 26, 69, 248, 129, 20, 29, 238, 61, 215, 82, 4, 197, 100, 138, 254, 80, 159, 203, 82, 153, 75, 36, 145, 51, 36, 49, 122, 191, 45, 200, 191, 131, 83, 14, 198, 57, 242, 153, 174, 33, 72, 165, 140, 41, 105, 173, 49, 150, 113, 133, 164, 34, 50, 195, 198, 24, 45, 93, 191, 181, 153, 101, 214, 130, 148, 138, 27, 8, 154, 158, 226, 177, 4, 65, 17, 33, 25, 181, 85, 248, 235, 16, 228, 227, 254, 23, 4, 225, 233, 4, 253, 169, 171, 124, 221, 212, 151, 8, 162, 103, 8, 66, 68, 220, 151, 32, 231, 222, 100, 148, 32, 159, 233, 26, 130, 56, 1, 72, 0, 171, 176, 225, 80, 17, 14, 141, 228, 152, 74, 147, 98, 146, 26, 12, 165, 53, 82, 107, 154, 90, 126, 3, 65, 211, 83, 60, 124, 15, 114, 111, 114, 248, 166, 61, 8, 79, 124, 147, 195, 242, 215, 219, 131, 14, 255, 213, 94, 75, 16, 184, 102, 15, 210, 111, 106, 97, 127, 47, 178, 114, 148, 162, 93, 203, 13, 109, 63, 79, 197, 161, 255, 88, 245, 47, 0, 0, 0, 255, 255, 3, 0, 128, 141, 126, 53, 193, 143}

	signedFile = []byte{120, 97, 114, 33, 0, 28, 0, 1, 0, 0, 0, 0, 0, 0, 17, 32, 0, 0, 0, 0, 0, 0, 61, 104, 0, 0, 0, 1, 120, 218, 236, 91, 105, 111, 218, 90, 183, 254, 142, 196, 127, 168, 122, 63, 162, 30, 207, 83, 148, 211, 87, 158, 7, 108, 131, 141, 25, 204, 55, 207, 216, 120, 0, 108, 176, 205, 175, 191, 27, 72, 210, 164, 73, 219, 244, 246, 232, 232, 189, 82, 164, 160, 216, 123, 90, 219, 94, 235, 121, 214, 192, 230, 254, 63, 93, 145, 127, 58, 69, 135, 58, 173, 202, 191, 63, 35, 127, 193, 159, 63, 69, 101, 80, 133, 105, 153, 252, 253, 121, 238, 72, 95, 232, 207, 255, 249, 58, 184, 239, 188, 195, 215, 193, 167, 251, 166, 10, 192, 191, 79, 247, 193, 33, 242, 26, 48, 227, 75, 147, 22, 209, 87, 20, 70, 177, 47, 48, 14, 254, 28, 132, 190, 195, 145, 59, 148, 188, 135, 94, 14, 185, 78, 218, 68, 193, 182, 62, 22, 159, 234, 166, 207, 163, 191, 63, 215, 27, 15, 249, 124, 233, 249, 116, 95, 197, 113, 29, 53, 95, 225, 123, 232, 225, 234, 218, 90, 167, 231, 203, 226, 247, 208, 245, 226, 178, 4, 244, 184, 198, 245, 174, 78, 147, 210, 107, 142, 135, 232, 113, 69, 123, 198, 190, 92, 16, 125, 115, 69, 130, 252, 182, 228, 167, 251, 113, 212, 171, 101, 92, 125, 2, 47, 162, 172, 255, 254, 188, 105, 154, 221, 29, 4, 181, 109, 251, 87, 139, 253, 85, 29, 18, 8, 133, 97, 24, 130, 25, 8, 12, 8, 129, 200, 255, 185, 137, 248, 116, 191, 34, 96, 70, 240, 26, 239, 118, 123, 187, 231, 163, 67, 147, 198, 105, 224, 53, 209, 87, 67, 85, 165, 202, 225, 121, 78, 45, 18, 182, 85, 57, 54, 81, 85, 161, 47, 67, 211, 81, 86, 242, 210, 109, 5, 203, 213, 198, 213, 90, 221, 156, 2, 147, 181, 68, 157, 179, 216, 54, 114, 196, 198, 224, 107, 153, 69, 230, 34, 219, 182, 91, 91, 94, 160, 195, 193, 122, 217, 157, 2, 121, 209, 171, 98, 46, 170, 162, 153, 7, 165, 189, 91, 23, 121, 230, 174, 236, 157, 143, 226, 137, 181, 90, 192, 158, 204, 244, 222, 202, 38, 140, 153, 219, 106, 172, 43, 44, 44, 75, 23, 56, 132, 11, 20, 174, 94, 207, 56, 97, 189, 210, 224, 225, 192, 91, 174, 119, 46, 42, 193, 222, 146, 57, 170, 162, 132, 132, 50, 144, 94, 228, 48, 144, 235, 24, 156, 120, 149, 203, 39, 237, 216, 90, 113, 173, 47, 207, 147, 217, 146, 200, 244, 76, 212, 13, 118, 123, 237, 227, 54, 6, 191, 88, 24, 237, 112, 160, 108, 2, 211, 200, 140, 214, 20, 88, 216, 112, 146, 126, 226, 88, 216, 242, 218, 22, 180, 70, 198, 118, 70, 166, 130, 143, 136, 44, 51, 158, 203, 206, 162, 103, 112, 137, 204, 39, 197, 76, 171, 10, 135, 78, 187, 45, 120, 98, 131, 207, 23, 250, 112, 48, 89, 132, 138, 41, 24, 136, 117, 118, 187, 137, 195, 98, 92, 98, 46, 56, 214, 48, 12, 209, 206, 195, 98, 81, 251, 24, 151, 7, 41, 167, 217, 60, 167, 249, 165, 9, 187, 203, 174, 94, 175, 84, 82, 149, 180, 147, 91, 44, 250, 80, 166, 19, 91, 206, 193, 158, 84, 126, 179, 152, 157, 243, 149, 125, 182, 206, 230, 220, 64, 199, 207, 159, 170, 109, 199, 139, 121, 77, 44, 224, 0, 54, 206, 11, 193, 204, 196, 185, 193, 169, 143, 79, 172, 207, 11, 38, 189, 188, 35, 191, 231, 68, 240, 158, 86, 108, 199, 159, 89, 237, 182, 23, 215, 97, 183, 210, 12, 232, 147, 83, 51, 214, 228, 146, 237, 126, 179, 77, 101, 166, 133, 57, 240, 20, 18, 203, 78, 120, 214, 162, 217, 75, 63, 159, 140, 193, 181, 200, 98, 27, 231, 100, 29, 71, 193, 112, 208, 35, 212, 206, 43, 167, 71, 175, 237, 246, 118, 122, 92, 133, 236, 202, 27, 37, 178, 25, 156, 248, 195, 84, 71, 156, 209, 168, 221, 109, 195, 210, 179, 201, 101, 172, 136, 158, 99, 192, 86, 183, 72, 231, 19, 126, 214, 238, 4, 136, 100, 203, 51, 202, 238, 188, 101, 60, 28, 64, 211, 162, 108, 246, 106, 195, 86, 39, 100, 189, 141, 37, 102, 142, 180, 116, 124, 216, 108, 10, 41, 54, 74, 126, 204, 246, 78, 195, 118, 208, 17, 90, 197, 135, 117, 28, 194, 180, 14, 237, 58, 83, 87, 167, 84, 14, 17, 120, 52, 106, 52, 217, 119, 182, 179, 124, 56, 216, 29, 248, 86, 165, 8, 124, 220, 46, 109, 167, 200, 89, 123, 100, 215, 142, 134, 186, 171, 177, 24, 208, 37, 17, 182, 77, 54, 154, 75, 7, 39, 201, 114, 221, 93, 18, 208, 106, 174, 238, 139, 53, 186, 113, 179, 44, 233, 210, 83, 80, 31, 69, 93, 152, 197, 242, 112, 48, 111, 231, 182, 159, 117, 120, 23, 239, 48, 85, 178, 171, 218, 194, 84, 65, 128, 187, 52, 137, 121, 37, 15, 151, 102, 21, 140, 173, 64, 172, 23, 122, 183, 61, 166, 237, 130, 144, 178, 209, 65, 175, 242, 72, 232, 145, 190, 114, 133, 108, 149, 163, 178, 182, 172, 135, 3, 184, 64, 177, 162, 200, 139, 152, 110, 50, 158, 114, 100, 155, 237, 41, 186, 150, 136, 96, 182, 107, 55, 135, 67, 58, 114, 116, 135, 15, 14, 147, 238, 76, 144, 185, 165, 10, 172, 197, 114, 21, 174, 242, 146, 192, 243, 236, 134, 109, 133, 139, 205, 219, 176, 51, 28, 176, 150, 2, 113, 172, 218, 178, 2, 27, 95, 244, 167, 204, 12, 81, 22, 216, 101, 194, 217, 43, 105, 132, 166, 103, 166, 163, 139, 177, 104, 225, 211, 126, 180, 233, 225, 154, 62, 26, 171, 133, 192, 177, 92, 146, 28, 184, 68, 148, 56, 43, 0, 122, 181, 0, 90, 12, 65, 109, 13, 214, 85, 199, 173, 203, 113, 214, 92, 49, 88, 89, 214, 228, 13, 28, 42, 44, 169, 247, 204, 201, 197, 204, 86, 47, 164, 54, 144, 187, 92, 47, 204, 147, 63, 187, 181, 25, 130, 209, 172, 1, 114, 189, 165, 213, 154, 103, 158, 7, 123, 178, 225, 139, 165, 133, 42, 59, 227, 89, 219, 106, 147, 68, 180, 46, 246, 2, 118, 253, 192, 1, 97, 182, 102, 231, 156, 161, 42, 35, 240, 17, 158, 237, 133, 103, 1, 130, 154, 164, 231, 106, 68, 3, 186, 243, 229, 124, 227, 23, 102, 174, 202, 0, 193, 138, 93, 121, 43, 35, 113, 209, 11, 10, 242, 194, 91, 154, 155, 16, 160, 214, 45, 183, 9, 208, 27, 161, 42, 220, 6, 112, 5, 161, 202, 210, 57, 192, 22, 205, 250, 50, 118, 105, 102, 235, 21, 7, 158, 14, 140, 200, 0, 51, 156, 214, 41, 7, 216, 99, 158, 0, 46, 200, 253, 20, 204, 0, 140, 113, 89, 201, 45, 186, 92, 85, 46, 120, 35, 182, 238, 74, 219, 2, 105, 121, 80, 32, 103, 176, 218, 113, 13, 64, 237, 163, 196, 22, 48, 206, 14, 236, 9, 37, 64, 43, 83, 168, 202, 226, 188, 158, 181, 175, 246, 19, 200, 204, 101, 69, 226, 113, 230, 5, 103, 47, 152, 72, 225, 122, 176, 175, 43, 63, 153, 55, 153, 43, 59, 247, 151, 139, 99, 168, 24, 71, 67, 112, 101, 254, 194, 137, 214, 92, 226, 0, 143, 74, 233, 174, 10, 21, 187, 157, 164, 244, 41, 196, 66, 236, 59, 13, 100, 47, 153, 110, 189, 124, 198, 114, 51, 186, 149, 218, 171, 157, 228, 55, 43, 129, 91, 190, 125, 174, 1, 203, 52, 184, 155, 166, 132, 196, 90, 114, 156, 93, 128, 167, 43, 144, 150, 247, 199, 120, 16, 79, 143, 145, 6, 239, 84, 33, 170, 22, 154, 30, 11, 14, 59, 185, 218, 151, 69, 115, 108, 76, 139, 128, 179, 120, 14, 103, 91, 165, 117, 199, 223, 86, 116, 57, 213, 178, 108, 129, 165, 251, 171, 61, 245, 134, 16, 244, 128, 51, 129, 141, 128, 143, 84, 181, 226, 119, 163, 133, 68, 228, 160, 214, 226, 47, 222, 224, 13, 15, 33, 0, 203, 225, 128, 61, 113, 211, 109, 209, 86, 243, 189, 49, 59, 77, 16, 119, 21, 49, 189, 228, 187, 10, 45, 5, 18, 234, 226, 169, 181, 116, 246, 205, 146, 9, 107, 241, 228, 157, 82, 91, 135, 157, 150, 92, 173, 91, 85, 240, 84, 186, 217, 41, 168, 23, 141, 76, 213, 144, 116, 128, 96, 109, 12, 193, 251, 21, 4, 215, 188, 91, 236, 70, 99, 192, 185, 117, 69, 113, 171, 52, 231, 103, 118, 74, 174, 35, 95, 97, 242, 202, 220, 26, 222, 124, 93, 173, 8, 178, 69, 79, 218, 172, 182, 106, 40, 153, 28, 117, 49, 157, 67, 113, 115, 84, 236, 6, 211, 134, 3, 250, 168, 180, 163, 32, 115, 199, 181, 86, 27, 203, 57, 46, 139, 85, 58, 50, 211, 152, 25, 241, 165, 68, 134, 208, 162, 239, 40, 74, 72, 130, 132, 22, 157, 158, 67, 249, 220, 235, 87, 126, 230, 160, 237, 60, 237, 5, 59, 71, 82, 168, 194, 226, 179, 34, 13, 7, 82, 41, 172, 194, 173, 21, 24, 146, 80, 107, 141, 74, 75, 180, 84, 8, 103, 135, 244, 29, 37, 227, 225, 101, 213, 185, 187, 52, 45, 207, 132, 71, 65, 181, 207, 47, 218, 73, 78, 5, 57, 170, 206, 235, 163, 144, 31, 185, 42, 21, 50, 93, 89, 79, 233, 209, 112, 80, 227, 181, 44, 152, 109, 48, 21, 83, 74, 84, 202, 84, 161, 124, 121, 159, 194, 76, 54, 81, 26, 162, 223, 187, 104, 48, 235, 78, 237, 110, 238, 176, 251, 9, 229, 8, 226, 180, 91, 146, 171, 49, 251, 247, 61, 244, 189, 55, 255, 177, 147, 23, 185, 11, 5, 29, 251, 39, 39, 47, 43, 251, 221, 222, 24, 47, 85, 171, 125, 211, 201, 187, 175, 29, 106, 55, 28, 136, 103, 214, 190, 185, 27, 16, 52, 108, 111, 38, 13, 28, 254, 209, 237, 241, 78, 203, 216, 237, 173, 175, 118, 148, 249, 99, 223, 219, 129, 0, 48, 253, 199, 80, 192, 118, 91, 233, 22, 10, 8, 98, 251, 20, 10, 204, 124, 148, 129, 193, 108, 206, 224, 240, 149, 224, 136, 253, 149, 230, 28, 96, 154, 142, 218, 153, 139, 10, 180, 169, 216, 165, 13, 24, 236, 183, 214, 55, 67, 147, 247, 6, 38, 23, 135, 250, 243, 208, 228, 189, 129, 201, 112, 240, 171, 208, 4, 0, 36, 53, 88, 88, 230, 103, 123, 121, 166, 250, 152, 96, 1, 100, 90, 115, 150, 197, 1, 221, 182, 236, 165, 127, 204, 86, 234, 5, 68, 22, 175, 133, 91, 90, 94, 18, 59, 142, 218, 207, 179, 113, 59, 206, 86, 76, 120, 158, 210, 44, 82, 171, 71, 145, 207, 104, 89, 83, 70, 101, 238, 64, 7, 0, 32, 231, 64, 89, 19, 216, 72, 70, 196, 18, 118, 235, 14, 170, 210, 121, 4, 33, 237, 86, 29, 14, 136, 41, 179, 44, 248, 237, 130, 32, 102, 225, 209, 1, 33, 79, 141, 194, 237, 68, 73, 221, 169, 51, 166, 248, 28, 183, 151, 249, 206, 149, 155, 56, 221, 233, 116, 153, 78, 139, 73, 173, 166, 245, 89, 154, 42, 250, 161, 111, 50, 123, 109, 29, 201, 118, 15, 156, 218, 112, 32, 107, 162, 216, 28, 76, 92, 207, 140, 56, 17, 231, 166, 189, 28, 81, 66, 190, 243, 227, 243, 161, 68, 217, 108, 197, 183, 120, 239, 199, 71, 217, 60, 218, 245, 158, 182, 236, 180, 228, 69, 109, 191, 143, 109, 83, 233, 142, 198, 154, 202, 185, 200, 159, 77, 3, 16, 86, 45, 57, 143, 84, 233, 101, 44, 57, 249, 168, 207, 49, 193, 200, 233, 41, 46, 105, 144, 53, 217, 143, 14, 236, 102, 155, 47, 78, 154, 188, 59, 231, 137, 81, 197, 30, 0, 155, 47, 80, 34, 32, 129, 88, 137, 58, 234, 128, 144, 137, 151, 33, 202, 126, 145, 204, 46, 86, 64, 39, 97, 186, 105, 20, 187, 7, 122, 199, 109, 111, 230, 1, 239, 231, 91, 162, 171, 107, 78, 2, 117, 139, 210, 177, 80, 107, 163, 175, 203, 52, 221, 147, 125, 137, 55, 154, 177, 65, 74, 141, 77, 12, 142, 101, 229, 44, 241, 220, 54, 241, 174, 65, 163, 117, 37, 223, 9, 199, 185, 162, 36, 5, 43, 202, 211, 167, 152, 210, 187, 149, 45, 36, 144, 78, 42, 250, 236, 12, 172, 61, 156, 27, 44, 125, 37, 97, 177, 189, 146, 161, 100, 176, 198, 133, 98, 47, 212, 122, 153, 159, 13, 7, 28, 151, 180, 82, 197, 206, 199, 12, 183, 179, 9, 27, 229, 99, 10, 246, 112, 248, 104, 141, 125, 204, 134, 17, 136, 151, 240, 86, 79, 174, 163, 99, 142, 15, 90, 205, 97, 179, 138, 151, 19, 5, 119, 67, 79, 177, 225, 64, 168, 78, 58, 106, 2, 203, 244, 121, 98, 115, 179, 68, 2, 184, 52, 24, 88, 29, 115, 10, 121, 34, 11, 10, 128, 222, 219, 10, 211, 155, 179, 176, 4, 54, 145, 101, 176, 19, 153, 79, 111, 182, 229, 162, 150, 204, 38, 174, 200, 38, 115, 22, 188, 167, 239, 172, 142, 111, 111, 86, 199, 90, 28, 63, 89, 217, 135, 42, 60, 203, 59, 149, 198, 198, 85, 127, 86, 172, 157, 120, 210, 230, 117, 76, 117, 235, 227, 184, 219, 140, 218, 200, 218, 102, 99, 2, 209, 105, 106, 56, 104, 23, 44, 225, 109, 109, 184, 58, 118, 190, 130, 9, 249, 190, 65, 116, 159, 107, 179, 96, 134, 196, 112, 176, 116, 78, 71, 210, 79, 75, 46, 79, 118, 240, 18, 239, 42, 75, 194, 183, 205, 222, 192, 24, 65, 217, 184, 51, 171, 173, 226, 243, 244, 200, 42, 149, 63, 28, 52, 138, 87, 55, 135, 37, 229, 48, 163, 74, 38, 48, 85, 94, 135, 99, 30, 89, 151, 58, 173, 142, 154, 195, 84, 76, 206, 135, 54, 68, 17, 184, 227, 241, 108, 30, 145, 222, 206, 50, 79, 238, 116, 150, 207, 198, 129, 220, 30, 26, 15, 223, 208, 177, 189, 93, 0, 42, 37, 180, 24, 209, 58, 30, 83, 121, 173, 247, 49, 221, 235, 114, 14, 233, 28, 56, 207, 16, 52, 99, 39, 69, 108, 86, 157, 58, 113, 71, 231, 201, 104, 111, 37, 60, 185, 40, 10, 1, 142, 12, 10, 22, 146, 157, 51, 221, 235, 164, 195, 36, 209, 161, 154, 45, 134, 131, 204, 25, 211, 139, 45, 170, 145, 171, 196, 197, 199, 189, 103, 29, 118, 164, 189, 57, 138, 85, 85, 78, 164, 73, 170, 194, 139, 84, 103, 246, 196, 178, 227, 91, 105, 188, 93, 158, 120, 38, 215, 1, 58, 166, 230, 184, 87, 59, 84, 2, 209, 177, 163, 105, 152, 161, 12, 7, 84, 165, 231, 206, 105, 209, 254, 22, 93, 31, 65, 68, 198, 146, 147, 71, 186, 230, 216, 87, 49, 253, 92, 98, 5, 46, 53, 172, 186, 229, 173, 43, 93, 201, 98, 171, 45, 230, 231, 111, 84, 52, 28, 240, 27, 227, 251, 44, 169, 48, 120, 235, 70, 84, 157, 17, 62, 246, 89, 47, 98, 161, 252, 4, 34, 44, 46, 92, 217, 149, 143, 105, 187, 80, 217, 2, 226, 151, 50, 16, 248, 221, 114, 30, 71, 120, 36, 119, 144, 219, 248, 152, 149, 88, 176, 216, 94, 51, 45, 193, 5, 153, 150, 138, 128, 140, 10, 6, 209, 37, 122, 205, 180, 206, 243, 75, 166, 69, 60, 182, 1, 200, 103, 63, 223, 245, 123, 247, 12, 72, 246, 23, 187, 254, 213, 158, 31, 73, 24, 188, 167, 95, 208, 48, 64, 213, 118, 235, 109, 53, 133, 80, 124, 101, 27, 90, 100, 187, 106, 86, 101, 33, 234, 81, 141, 86, 121, 104, 44, 162, 94, 151, 221, 50, 26, 14, 70, 243, 166, 102, 172, 232, 0, 114, 48, 158, 228, 146, 209, 72, 98, 53, 24, 99, 184, 189, 150, 17, 112, 176, 43, 74, 222, 62, 136, 33, 159, 29, 71, 150, 63, 174, 141, 56, 95, 19, 164, 48, 182, 149, 20, 57, 205, 165, 44, 56, 247, 180, 53, 117, 2, 124, 14, 156, 81, 168, 104, 242, 74, 71, 86, 22, 181, 136, 145, 145, 79, 167, 115, 225, 152, 47, 167, 206, 2, 54, 233, 165, 133, 168, 221, 66, 151, 22, 219, 176, 38, 28, 140, 217, 245, 209, 25, 225, 201, 118, 177, 177, 214, 56, 173, 54, 188, 128, 245, 100, 91, 131, 120, 23, 16, 90, 147, 209, 32, 102, 239, 49, 139, 166, 167, 165, 131, 157, 199, 240, 182, 146, 235, 108, 116, 62, 44, 9, 161, 201, 35, 197, 244, 245, 169, 63, 39, 15, 177, 53, 21, 18, 126, 198, 83, 226, 70, 74, 9, 24, 113, 90, 19, 69, 213, 229, 158, 52, 187, 237, 54, 4, 89, 203, 34, 144, 79, 58, 44, 159, 71, 211, 83, 22, 24, 88, 81, 193, 157, 20, 111, 24, 195, 67, 248, 165, 229, 150, 98, 40, 171, 186, 168, 154, 220, 230, 60, 25, 39, 190, 216, 46, 39, 157, 199, 9, 99, 195, 211, 39, 83, 37, 36, 242, 0, 98, 202, 85, 177, 164, 135, 131, 89, 184, 65, 203, 179, 49, 95, 123, 18, 150, 27, 219, 230, 137, 134, 19, 137, 188, 228, 28, 97, 246, 58, 110, 101, 45, 183, 21, 110, 228, 234, 220, 200, 110, 14, 158, 142, 189, 208, 239, 153, 13, 111, 163, 113, 81, 74, 172, 159, 18, 238, 35, 61, 127, 79, 206, 192, 10, 222, 24, 13, 44, 192, 190, 229, 103, 172, 8, 174, 213, 203, 222, 174, 161, 148, 197, 62, 209, 40, 32, 88, 137, 117, 120, 142, 206, 216, 253, 37, 39, 2, 196, 255, 152, 21, 217, 110, 116, 37, 114, 197, 184, 228, 98, 32, 15, 8, 142, 238, 205, 126, 143, 46, 202, 52, 58, 122, 179, 74, 23, 21, 79, 111, 101, 84, 64, 119, 155, 253, 53, 167, 250, 211, 140, 234, 146, 73, 221, 114, 170, 63, 205, 168, 174, 153, 212, 53, 167, 250, 211, 140, 106, 56, 120, 204, 169, 222, 204, 168, 190, 115, 84, 156, 245, 228, 168, 2, 115, 151, 27, 250, 42, 197, 40, 23, 176, 252, 212, 196, 134, 131, 2, 210, 80, 184, 12, 90, 135, 22, 227, 141, 59, 145, 100, 98, 203, 216, 231, 184, 223, 175, 27, 54, 75, 207, 243, 122, 205, 206, 80, 157, 130, 3, 226, 116, 132, 11, 107, 218, 99, 249, 212, 52, 211, 116, 122, 202, 113, 8, 61, 169, 220, 168, 99, 38, 238, 4, 132, 36, 243, 94, 112, 38, 6, 136, 184, 137, 221, 148, 47, 78, 208, 24, 234, 214, 187, 118, 174, 197, 92, 200, 46, 54, 98, 20, 154, 19, 44, 237, 13, 202, 38, 167, 11, 191, 119, 82, 146, 145, 177, 192, 164, 167, 118, 36, 150, 253, 73, 106, 162, 9, 86, 54, 118, 176, 26, 14, 246, 102, 55, 82, 179, 213, 88, 11, 87, 107, 129, 89, 31, 144, 177, 186, 85, 59, 5, 171, 188, 126, 26, 224, 82, 210, 109, 26, 159, 159, 141, 102, 245, 105, 35, 206, 166, 92, 50, 209, 240, 5, 227, 192, 197, 186, 231, 199, 6, 122, 192, 4, 23, 4, 30, 199, 35, 120, 227, 58, 148, 59, 94, 222, 108, 91, 217, 56, 135, 80, 64, 114, 61, 72, 1, 152, 106, 170, 90, 148, 119, 44, 141, 181, 67, 173, 214, 102, 9, 113, 27, 100, 181, 222, 17, 5, 97, 108, 117, 10, 53, 23, 93, 89, 146, 155, 249, 33, 240, 79, 107, 147, 215, 56, 117, 63, 28, 116, 45, 29, 54, 91, 52, 88, 21, 83, 117, 134, 179, 171, 249, 120, 63, 70, 194, 195, 22, 50, 89, 141, 59, 71, 109, 184, 154, 111, 126, 224, 168, 110, 205, 79, 197, 196, 123, 232, 161, 40, 121, 43, 122, 62, 213, 57, 175, 183, 221, 151, 87, 117, 79, 222, 152, 125, 87, 247, 164, 200, 55, 10, 159, 12, 138, 124, 84, 62, 63, 42, 159, 31, 149, 207, 143, 202, 231, 71, 229, 243, 163, 242, 249, 81, 249, 252, 168, 124, 126, 84, 62, 63, 42, 159, 31, 149, 207, 143, 202, 231, 71, 229, 243, 163, 242, 249, 81, 249, 252, 168, 124, 126, 84, 62, 63, 42, 159, 31, 149, 207, 143, 202, 231, 127, 73, 229, 243, 89, 173, 243, 218, 16, 167, 121, 244, 41, 13, 255, 254, 76, 62, 212, 59, 195, 167, 42, 228, 125, 30, 149, 73, 179, 249, 74, 49, 216, 61, 244, 112, 125, 235, 120, 60, 207, 250, 88, 45, 245, 118, 187, 252, 178, 131, 180, 42, 161, 42, 104, 162, 230, 11, 136, 19, 34, 175, 248, 12, 61, 76, 120, 40, 156, 34, 24, 142, 18, 36, 76, 227, 47, 74, 169, 15, 181, 212, 171, 152, 167, 82, 42, 16, 210, 53, 7, 15, 44, 22, 126, 121, 251, 152, 43, 0, 105, 224, 97, 68, 128, 199, 62, 78, 120, 1, 237, 199, 49, 21, 163, 164, 23, 4, 1, 236, 49, 52, 26, 162, 52, 26, 16, 20, 114, 15, 189, 94, 233, 65, 132, 119, 8, 54, 233, 233, 31, 144, 240, 106, 161, 135, 87, 255, 244, 50, 239, 165, 180, 12, 163, 3, 127, 57, 194, 27, 57, 15, 231, 119, 65, 115, 233, 149, 85, 29, 5, 85, 25, 214, 151, 179, 186, 207, 111, 111, 3, 174, 103, 125, 17, 6, 134, 191, 192, 200, 23, 24, 118, 96, 244, 142, 192, 239, 46, 231, 109, 31, 79, 1, 3, 49, 111, 46, 126, 31, 60, 59, 74, 140, 125, 193, 96, 7, 33, 238, 8, 248, 14, 99, 214, 247, 80, 240, 109, 118, 241, 147, 97, 197, 183, 97, 222, 79, 134, 121, 223, 134, 37, 135, 234, 184, 251, 90, 55, 94, 28, 223, 67, 183, 155, 91, 123, 26, 94, 207, 14, 95, 254, 95, 27, 142, 117, 116, 248, 122, 110, 189, 186, 190, 135, 174, 215, 183, 86, 208, 13, 60, 26, 104, 122, 28, 87, 84, 97, 244, 21, 38, 97, 48, 247, 122, 121, 51, 210, 232, 148, 6, 81, 89, 125, 69, 72, 138, 162, 80, 20, 76, 120, 106, 186, 14, 72, 203, 203, 88, 26, 195, 17, 154, 129, 153, 123, 232, 118, 127, 237, 106, 250, 93, 244, 245, 98, 246, 224, 21, 94, 46, 7, 55, 61, 128, 7, 16, 82, 96, 182, 169, 127, 188, 216, 241, 69, 23, 197, 175, 59, 239, 161, 203, 74, 47, 145, 244, 120, 4, 251, 31, 83, 57, 126, 135, 193, 127, 164, 114, 252, 125, 42, 199, 223, 167, 114, 252, 223, 81, 57, 69, 16, 255, 119, 149, 83, 175, 85, 30, 166, 135, 40, 104, 170, 67, 255, 74, 239, 190, 87, 71, 127, 237, 182, 201, 43, 157, 191, 213, 241, 164, 102, 244, 241, 187, 155, 240, 217, 247, 54, 15, 52, 137, 81, 56, 66, 189, 36, 205, 223, 103, 205, 39, 218, 100, 112, 6, 125, 201, 152, 15, 148, 249, 32, 230, 27, 105, 190, 131, 53, 227, 128, 196, 66, 31, 165, 66, 156, 244, 9, 44, 32, 194, 8, 112, 27, 29, 82, 33, 73, 199, 12, 29, 70, 72, 16, 133, 104, 72, 252, 152, 53, 127, 77, 155, 239, 22, 241, 54, 109, 62, 231, 205, 31, 161, 232, 215, 48, 122, 141, 35, 20, 189, 67, 233, 59, 228, 57, 142, 126, 4, 164, 247, 34, 233, 189, 80, 122, 47, 150, 126, 8, 166, 215, 104, 250, 1, 156, 222, 192, 211, 19, 135, 226, 248, 51, 64, 253, 26, 81, 47, 33, 133, 195, 207, 33, 245, 54, 141, 62, 192, 134, 171, 138, 103, 136, 121, 179, 241, 27, 111, 62, 67, 20, 246, 19, 68, 93, 66, 7, 152, 70, 41, 248, 31, 67, 21, 78, 94, 61, 195, 27, 176, 122, 38, 235, 119, 160, 21, 123, 8, 48, 118, 138, 65, 49, 47, 14, 65, 142, 18, 33, 158, 7, 204, 31, 197, 72, 140, 36, 25, 6, 35, 72, 154, 8, 61, 52, 254, 3, 104, 189, 95, 196, 191, 11, 45, 152, 0, 150, 124, 71, 160, 127, 4, 45, 250, 157, 208, 162, 223, 7, 45, 236, 95, 132, 214, 75, 95, 245, 187, 208, 66, 232, 119, 67, 107, 234, 245, 121, 229, 133, 175, 225, 245, 186, 227, 77, 136, 225, 63, 129, 24, 73, 252, 115, 46, 235, 26, 233, 19, 8, 245, 54, 192, 174, 146, 126, 7, 90, 158, 79, 146, 30, 19, 69, 97, 24, 145, 148, 135, 50, 30, 206, 196, 88, 24, 134, 1, 3, 218, 163, 40, 142, 200, 40, 130, 125, 130, 254, 3, 104, 189, 95, 196, 191, 11, 45, 132, 190, 67, 153, 187, 139, 121, 254, 247, 64, 235, 58, 238, 255, 5, 180, 176, 247, 67, 107, 22, 28, 210, 93, 83, 191, 134, 214, 235, 142, 55, 161, 69, 252, 4, 90, 40, 78, 255, 195, 208, 162, 49, 242, 77, 104, 93, 37, 253, 14, 180, 40, 28, 70, 105, 56, 242, 176, 144, 66, 60, 156, 66, 66, 134, 194, 8, 38, 244, 49, 220, 15, 49, 132, 137, 66, 38, 8, 8, 63, 162, 254, 0, 90, 239, 23, 241, 175, 123, 45, 16, 16, 98, 127, 228, 181, 176, 119, 6, 132, 24, 243, 223, 231, 181, 94, 38, 213, 191, 11, 45, 248, 119, 188, 86, 176, 245, 146, 232, 82, 133, 122, 203, 115, 189, 213, 249, 44, 177, 126, 188, 2, 235, 94, 126, 44, 125, 15, 93, 127, 58, 253, 191, 0, 0, 0, 255, 255, 3, 0, 136, 107, 29, 129}
)
