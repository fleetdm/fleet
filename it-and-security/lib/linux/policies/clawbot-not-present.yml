- name: Linux - Clawbot/moltbot not present
  query: >-
    SELECT 1 WHERE
    NOT EXISTS (SELECT 1 FROM deb_packages WHERE name IN ('clawbot', 'moltbot'))
    AND NOT EXISTS (SELECT 1 FROM rpm_packages WHERE name IN ('clawbot', 'moltbot'))
    AND NOT EXISTS (SELECT 1 FROM processes WHERE name IN ('clawbot', 'moltbot'))
    AND NOT EXISTS (SELECT 1 FROM file WHERE path IN ('/usr/local/bin/clawbot', '/usr/local/bin/moltbot', '/opt/clawbot/clawbot', '/opt/moltbot/moltbot'));
  critical: true
  description: This policy checks that Clawbot (also known as moltbot) is not installed on the host.
  resolution: "Clawbot/moltbot should be automatically removed. If it persists, drop a note in #help-it."
  run_script:
    path: ../scripts/uninstall-clawbot-linux.sh
  platform: linux
